(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    372046,      10148]
NotebookOptionsPosition[    357386,       9920]
NotebookOutlinePosition[    358282,       9946]
CellTagsIndexPosition[    358176,       9941]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/gangchen/Documents/GitHub/kinematicHopfAlgebra\>\"", "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Get", "[", "\"\<basicfun.m\>\"", "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<KiHa.wl\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.869017756626953*^9, 3.869017796936942*^9}, 
   3.869017940661934*^9, {3.869017980837627*^9, 3.869017998586751*^9}, {
   3.869269850277069*^9, 3.869269861410946*^9}, {3.869269921749385*^9, 
   3.869269930196027*^9}, 3.869269978872448*^9, {3.871212170414*^9, 
   3.871212170741899*^9}, 3.8712528702230043`*^9, 3.871253176496983*^9, {
   3.871267465300568*^9, 3.871267471825403*^9}, {3.9039044387942057`*^9, 
   3.9039044683534117`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"8b241212-cb5e-4c49-a1af-98e2bcd66219"],

Cell[BoxData["\<\"/Users/gangchen/Documents/GitHub/kinematicHopfAlgebra\"\>"],\
 "Output",
 CellChangeTimes->{
  3.86926998187879*^9, 3.871187696158182*^9, {3.871187726743794*^9, 
   3.8711877474145823`*^9}, 3.871188092674917*^9, 3.871188574169098*^9, 
   3.871188672264854*^9, 3.871188948330041*^9, 3.8711889994139147`*^9, {
   3.871189232416047*^9, 3.871189242962035*^9}, 3.871192266504133*^9, 
   3.871192711206381*^9, 3.871192744006569*^9, 3.87119277862864*^9, 
   3.8711930649533157`*^9, 3.871193477321451*^9, 3.871194146230261*^9, 
   3.871194423756912*^9, 3.871194935228981*^9, 3.871195105222465*^9, 
   3.87119538564555*^9, 3.8712111006814337`*^9, 3.871211848932613*^9, 
   3.871211936744568*^9, 3.871211997992154*^9, 3.8712121287862463`*^9, {
   3.871212255141457*^9, 3.871212265349888*^9}, {3.8712123540513697`*^9, 
   3.871212405393598*^9}, {3.871212456695116*^9, 3.871212465719149*^9}, 
   3.8712125267807207`*^9, {3.871251581659773*^9, 3.871251605032814*^9}, 
   3.871252287730563*^9, {3.871252770297418*^9, 3.871252789900475*^9}, 
   3.871252841231598*^9, {3.871252871308982*^9, 3.8712528849405413`*^9}, {
   3.871253193034992*^9, 3.871253203003531*^9}, 3.8712539648759203`*^9, 
   3.8712541498809*^9, 3.871254630017508*^9, {3.8712560205068827`*^9, 
   3.871256042343101*^9}, {3.871256795322289*^9, 3.87125680885038*^9}, 
   3.8712571156446466`*^9, {3.871257500138839*^9, 3.8712575213644743`*^9}, 
   3.87125757127155*^9, {3.871257614309973*^9, 3.8712576724128113`*^9}, {
   3.871257948666696*^9, 3.871257957638459*^9}, {3.871258014775528*^9, 
   3.8712580408792953`*^9}, {3.871259558021562*^9, 3.8712595790826073`*^9}, 
   3.8712598889257298`*^9, 3.871259964821887*^9, {3.871260215898757*^9, 
   3.8712602277231894`*^9}, 3.871260423473901*^9, {3.871260462995697*^9, 
   3.871260472782424*^9}, 3.8712605839602947`*^9, 3.8712606264692173`*^9, {
   3.871267473960013*^9, 3.87126748635151*^9}, 3.87126786446835*^9, 
   3.871268224755621*^9, 3.871268292274819*^9, 3.871268944953556*^9, 
   3.87126911453413*^9, 3.871269915752988*^9, 3.879638656742285*^9, 
   3.879638777824671*^9, 3.8796391076328897`*^9, 3.879640100658719*^9, 
   3.879640140219673*^9, 3.879640477343555*^9, {3.8856329385350523`*^9, 
   3.885632951191571*^9}, {3.895028607762595*^9, 3.8950286186313963`*^9}, {
   3.900144122415745*^9, 3.900144133015683*^9}, 3.903904419718666*^9, {
   3.903904469207267*^9, 3.903904498226782*^9}},
 CellLabel->"Out[1]=",ExpressionUUID->"a5f81c39-a20b-470b-849c-79822b0a5435"],

Cell["\<\
 KiHA(v2.0),Copyright 2022,author Gang Chen. It is licensed under the GNU \
General Public License v3.0.
 KiHA is based on the work of Kinematic Hopf Algebra in CTP of Queen Mary \
University of London.
 It generates the duality all-n numerator for colour-kinematic duality and \
double copy in heavy mass effective 
 theory(HEFT), Yang-Mills/Gravity theory and Yang-Mills-Scalar/Gravity-Scalar. 
 KiHA is built on some basic functions written by Gustav Mogull and Gregor \
Kaelin.
 use ?KiHA`* for help and a series of papers (2111.15649, 2208.05519, \
2208.05886) for more reference.\
\>", "Print",
 CellFrame->0.5,
 CellChangeTimes->{3.9039044982314997`*^9},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"a0402c5a-8c71-4c9a-900f-166a6104d516"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"p", ",", "F"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"declareVectorHead", "[", 
  RowBox[{"{", 
   RowBox[{"p", ",", "\[Epsilon]"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"declareTensorHead", "[", 
  RowBox[{
   RowBox[{"{", "F", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<rank\>\"", "\[Rule]", " ", "2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"p", ",", "F"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8712580675477324`*^9, 3.8712580867792883`*^9}, {
   3.871258142937771*^9, 3.871258148840885*^9}, {3.8712582030267344`*^9, 
   3.87125821063772*^9}, {3.871258477914794*^9, 3.871258502589952*^9}, 
   3.871260089247224*^9, 3.87126797292529*^9, {3.871268029057691*^9, 
   3.871268030682728*^9}, {3.8712680652578363`*^9, 3.871268065465754*^9}, {
   3.9039134760023413`*^9, 3.903913476510518*^9}},
 CellLabel->
  "In[387]:=",ExpressionUUID->"6a6bb66f-8473-455a-bd23-80e7f0254686"],

Cell[CellGroupData[{

Cell[BoxData["\<\"p undeclared as a tensor header.\"\>"], "Print",
 CellChangeTimes->{
  3.871258211352558*^9, {3.871258489423747*^9, 3.871258503368997*^9}, 
   3.871259583838159*^9, 3.8712679739519978`*^9, 3.871268034055801*^9, 
   3.87126828131813*^9, 3.871268947123712*^9, 3.8712691169657393`*^9, 
   3.879638660119526*^9, 3.879638779729953*^9, 3.87963910938972*^9, 
   3.879640102937992*^9, 3.879640142495597*^9, 3.879640480068983*^9, 
   3.885632954689515*^9, 3.895028629306066*^9, 3.900144139581938*^9, 
   3.9039045059610558`*^9, 3.903913477450911*^9},
 CellLabel->
  "During evaluation of \
In[387]:=",ExpressionUUID->"962706e2-8abe-460b-8957-7c6623f68bf0"],

Cell[BoxData["\<\"p declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.871258211352558*^9, {3.871258489423747*^9, 3.871258503368997*^9}, 
   3.871259583838159*^9, 3.8712679739519978`*^9, 3.871268034055801*^9, 
   3.87126828131813*^9, 3.871268947123712*^9, 3.8712691169657393`*^9, 
   3.879638660119526*^9, 3.879638779729953*^9, 3.87963910938972*^9, 
   3.879640102937992*^9, 3.879640142495597*^9, 3.879640480068983*^9, 
   3.885632954689515*^9, 3.895028629306066*^9, 3.900144139581938*^9, 
   3.9039045059610558`*^9, 3.903913477453082*^9},
 CellLabel->
  "During evaluation of \
In[387]:=",ExpressionUUID->"1750d722-cbc7-45b0-aaf8-abf3ce87f0bc"],

Cell[BoxData["\<\"\[Epsilon] declared as a 4-dimensional vector \
header.\"\>"], "Print",
 CellChangeTimes->{
  3.871258211352558*^9, {3.871258489423747*^9, 3.871258503368997*^9}, 
   3.871259583838159*^9, 3.8712679739519978`*^9, 3.871268034055801*^9, 
   3.87126828131813*^9, 3.871268947123712*^9, 3.8712691169657393`*^9, 
   3.879638660119526*^9, 3.879638779729953*^9, 3.87963910938972*^9, 
   3.879640102937992*^9, 3.879640142495597*^9, 3.879640480068983*^9, 
   3.885632954689515*^9, 3.895028629306066*^9, 3.900144139581938*^9, 
   3.9039045059610558`*^9, 3.90391347745607*^9},
 CellLabel->
  "During evaluation of \
In[387]:=",ExpressionUUID->"b426430e-645b-437e-bbdb-65354f74716a"],

Cell[BoxData["\<\"F declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.871258211352558*^9, {3.871258489423747*^9, 3.871258503368997*^9}, 
   3.871259583838159*^9, 3.8712679739519978`*^9, 3.871268034055801*^9, 
   3.87126828131813*^9, 3.871268947123712*^9, 3.8712691169657393`*^9, 
   3.879638660119526*^9, 3.879638779729953*^9, 3.87963910938972*^9, 
   3.879640102937992*^9, 3.879640142495597*^9, 3.879640480068983*^9, 
   3.885632954689515*^9, 3.895028629306066*^9, 3.900144139581938*^9, 
   3.9039045059610558`*^9, 3.903913477457995*^9},
 CellLabel->
  "During evaluation of \
In[387]:=",ExpressionUUID->"af4d8d18-723f-46e9-a15b-a6a5006a8941"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "testfun", "]"}], "\[IndentingNewLine]", 
    RowBox[{"SetAttributes", "[", 
     RowBox[{"testfun", ",", 
      RowBox[{"{", "NHoldAll", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"declareDistributive", "[", 
    RowBox[{"testfun", ",", "vectorQ"}], "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.871251409243869*^9, 3.871251439768927*^9}, {
  3.87126932018608*^9, 
  3.871269323736904*^9}},ExpressionUUID->"ca79a261-126a-4970-a7e6-\
9cc5f4f13621"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "KiHA`*"}]], "Input",
 CellChangeTimes->{{3.903907791070559*^9, 3.903907791073591*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"09aa9921-dc9d-4005-9867-5b17dffafd4b"],

Cell[BoxData[
 StyleBox[
  FrameBox[GridBox[{
     {
      DynamicModuleBox[{Typeset`open$$ = True}, 
       PaneSelectorBox[{False->
        ButtonBox[
         RowBox[{
          
          DynamicBox[FEPrivate`FrontEndResource[
           "FEBitmaps", "RightPointerOpener"]], " ", 
          StyleBox["KiHA`", "InformationGridGroupHeader"]}],
         Appearance->None,
         BaseStyle->"InformationGridLink",
         ButtonFunction:>FEPrivate`Set[Typeset`open$$, True],
         Evaluator->Automatic,
         Method->"Preemptive"], True->
        PaneBox[GridBox[{
           {
            ButtonBox[
             RowBox[{
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{13., {3., 10.}}], " ", 
              StyleBox["KiHA`", "InformationGridGroupHeader"]}],
             Appearance->None,
             BaseStyle->"InformationGridLink",
             ButtonFunction:>FEPrivate`Set[Typeset`open$$, False],
             Evaluator->Automatic,
             Method->"Preemptive"]},
           {
            PaneBox[GridBox[{
               {
                ButtonBox[
                 StyleBox["aMu", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "aMu", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["freeIndices", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "freeIndices", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spAA", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "spAA", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["antiTensorQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "antiTensorQ", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["FT", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "FT", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spAB", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "spAB", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["basisExpand", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "basisExpand", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["FT2F", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "FT2F", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spB", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "spB", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["BinaryProduct", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "BinaryProduct", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["GBinaryProduct", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "GBinaryProduct", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spBA", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "spBA", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["contract", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "contract", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["GT", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "GT", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spBB", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "spBB", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["contractAnti", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "contractAnti", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["GT2F", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "GT2F", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spOuter", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "spOuter", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["contractSp", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "contractSp", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["indexCoefficient", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "indexCoefficient", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spp", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "spp", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["contractspp", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "contractspp", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["JQCD", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "JQCD", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "spQ", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["ddmBasis", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "ddmBasis", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["KLTR", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "KLTR", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["T", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {"T", "KiHA`"},
                    False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareAntisymmetric", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "declareAntisymmetric", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["KLTRM", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "KLTRM", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["T2F", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "T2F", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareAntiTensorHead", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "declareAntiTensorHead", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["KSetPartitions", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "KSetPartitions", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["tensorDim", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "tensorDim", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareDistributive", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "declareDistributive", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["KSetPartitionsEmpty", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "KSetPartitionsEmpty", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["tensorQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "tensorQ", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareDistributiveFirst", "InformationGridButton"],
                 
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "declareDistributiveFirst", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["lgScaling", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "lgScaling", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["tensorQR2", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "tensorQR2", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareDistributiveLast", "InformationGridButton"],
                 
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "declareDistributiveLast", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["lI", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "lI", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["tensorRank", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "tensorRank", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 
                 StyleBox["declareDistributiveMiddle", 
                  "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "declareDistributiveMiddle", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["m", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {"m", "KiHA`"},
                    False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["toSpinors", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "toSpinors", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareSymmetric", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "declareSymmetric", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["massDim", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "massDim", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["tr", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "tr", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareTensor", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "declareTensor", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["mu", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "mu", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["undeclareTensor", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "undeclareTensor", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareTensorHead", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "declareTensorHead", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["NC", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "NC", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["undeclareTensorHead", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "undeclareTensorHead", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareVector", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "declareVector", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["nice", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "nice", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["v", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {"v", "KiHA`"},
                    False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareVectorHead", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "declareVectorHead", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["niceT", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "niceT", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["vectorQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "vectorQ", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["distributive", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "distributive", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["NumRec", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "NumRec", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["verbose", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "verbose", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["distributiveRules", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "distributiveRules", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["numRecQCD", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "numRecQCD", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["X", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {"X", "KiHA`"},
                    False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["dot", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "dot", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["outer", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "outer", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["X2Prop", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "X2Prop", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["dressIndex", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "dressIndex", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["p", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {"p", "KiHA`"},
                    False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[ScriptCapitalK]", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "\[ScriptCapitalK]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["eps", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "eps", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["parkeTaylor", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "parkeTaylor", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[DoubleStruckA]", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "\[DoubleStruckA]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["ET", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "ET", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["patternFreeQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "patternFreeQ", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[DoubleStruckCapitalI]", "InformationGridButton"],
                 
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "\[DoubleStruckCapitalI]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["ET2F", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "ET2F", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["protectedQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "protectedQ", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[DoubleStruckCapitalS]", "InformationGridButton"],
                 
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "\[DoubleStruckCapitalS]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["ET2F2s", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "ET2F2s", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["p$", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "p$", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[DoubleStruckT]", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "\[DoubleStruckT]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["eta", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "eta", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["rmzero", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "rmzero", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[CapitalDelta]", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "\[CapitalDelta]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["ExpandNCM", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "ExpandNCM", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["rmzeroT", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "rmzeroT", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[Epsilon]", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "\[Epsilon]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["expandTensor", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "expandTensor", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["setGlobalDim", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "setGlobalDim", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[CapitalOmega]", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "\[CapitalOmega]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["exposeIndex", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "exposeIndex", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["SetPartitionsOrdered", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "SetPartitionsOrdered", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[FivePointedStar]", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "\[FivePointedStar]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["F", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {"F", "KiHA`"},
                    False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["sp", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "sp", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], ""},
               {
                ButtonBox[
                 StyleBox["FRank2", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "FRank2", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spA", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-a32ac0e0-8683-4895-a907-2832647d6b92", {
                   "spA", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], ""}
              },
              DefaultBaseStyle->"Text",
              
              GridBoxAlignment->{
               "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
              GridBoxItemSize->{"Columns" -> {{
                   Scaled[0.31666666666666665`]}}}],
             ImageMargins->{{10, 0}, {0, 2}}]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}}],
         FrameMargins->{{0, 0}, {8, 0}}]}, Dynamic[Typeset`open$$],
        ImageSize->Automatic]]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{"ColumnsIndexed" -> {{False}}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.8]}, 
        Offset[0.2]}}],
   BaseStyle->"InformationTitleFrame"], "InformationGridPlain"]], "Output",
 CellChangeTimes->{3.9039077919537163`*^9},
 CellLabel->
  "Out[188]=",ExpressionUUID->"bbd91620-4e4c-4552-8722-19eaba98aceb"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"The propagators from the binary product. The last \
line is taken as on-shell\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[
           TagBox[GridBox[{
              {
               StyleBox[
                TagBox[
                 TooltipBox[
                  StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                   StripOnInput->False],
                  "\"Definitions\"",
                  TooltipStyle->"TextStyling"],
                 Annotation[#, "Definitions", "Tooltip"]& ], "DialogStyle",
                StripOnInput->False]},
              {
               TemplateBox[{"\"\[ThinSpace]\"", 
                 GridBox[{{
                    RowBox[{
                    RowBox[{"X2Prop", "[", "KiHA`Private`f_X", "]"}], ":=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"KiHA`Private`f", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "/.", "\[VeryThinSpace]", 
                    RowBox[{"KiHA`Private`i_", "\[RuleDelayed]", 
                    RowBox[{
                    RowBox[{"KiHA`Private`P", "[", "KiHA`Private`i", "]"}], 
                    "/;", 
                    RowBox[{"IntegerQ", "[", "KiHA`Private`i", "]"}]}]}]}], 
                    "/.", "\[VeryThinSpace]", 
                    RowBox[{"X", "\[Rule]", "KiHA`Private`propG"}]}], ")"}], 
                    " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"KiHA`Private`f", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "/.", "\[VeryThinSpace]", 
                    RowBox[{"KiHA`Private`i_", "\[RuleDelayed]", 
                    RowBox[{
                    RowBox[{"KiHA`Private`P", "[", "KiHA`Private`i", "]"}], 
                    "/;", 
                    RowBox[{"IntegerQ", "[", "KiHA`Private`i", "]"}]}]}]}], 
                    "/.", "\[VeryThinSpace]", 
                    RowBox[{"X", "\[Rule]", "KiHA`Private`propG"}]}], ")"}]}],
                     "/.", "\[VeryThinSpace]", 
                    RowBox[{
                    RowBox[{"KiHA`Private`P", "[", "KiHA`Private`ft__", "]"}],
                     "\[RuleDelayed]", "1"}]}]}]}, {" "}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                "RowDefault"]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"],
           FrameMargins->{{6, 0}, {3, 6}}], "\<\"\"\>"},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"KiHA`X2Prop\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"The propagators from the binary product. The last \
line is taken as on-shell\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{13., {2., 11.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{13., {2., 11.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[
   Association[
   "ObjectType" -> "Symbol", "Usage" -> 
    "The propagators from the binary product. The last line is taken as \
on-shell", "Documentation" -> None, "OwnValues" -> None, "UpValues" -> None, 
    "DownValues" -> 
    Information`InformationValueForm[DownValues, KiHA`X2Prop, {KiHA`X2Prop[
         Pattern[KiHA`Private`f, 
          Blank[KiHA`X]]] :> ReplaceAll[ReplaceAll[
           ReplaceAll[
            Part[KiHA`Private`f, 1], Pattern[KiHA`Private`i, 
              Blank[]] :> Condition[
              KiHA`Private`P[KiHA`Private`i], 
              IntegerQ[KiHA`Private`i]]], KiHA`X -> KiHA`Private`propG] 
         ReplaceAll[
           ReplaceAll[
            Part[KiHA`Private`f, 2], Pattern[KiHA`Private`i, 
              Blank[]] :> Condition[
              KiHA`Private`P[KiHA`Private`i], 
              IntegerQ[KiHA`Private`i]]], KiHA`X -> KiHA`Private`propG], 
         KiHA`Private`P[
           Pattern[KiHA`Private`ft, 
            BlankSequence[]]] :> 1]}], "SubValues" -> None, "DefaultValues" -> 
    None, "NValues" -> None, "FormatValues" -> None, "Options" -> None, 
    "Attributes" -> {}, "FullName" -> "KiHA`X2Prop"], False]]], "Print",
 CellTags->
  "Info-a32ac0e0-8683-4895-a907-2832647d6b92",ExpressionUUID->"cc47fdcf-3cd0-\
49d8-aa74-49a31feaca82"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SubFunctions", "Section",
 CellChangeTimes->{{3.810011820953319*^9, 
  3.810011824102497*^9}},ExpressionUUID->"d3d4ced6-cccd-443d-9493-\
a11ffd0a2e32"],

Cell[CellGroupData[{

Cell["general functions", "Subsection",
 CellChangeTimes->{{3.8717162484953003`*^9, 
  3.8717162609396152`*^9}},ExpressionUUID->"4bd1fb5d-59c6-4eee-afb5-\
56504466d7c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nicevs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", "i_", "]"}], ":>", "v"}], ",", 
       RowBox[{
        RowBox[{"S", "[", "i_", "]"}], ":>", "S"}], ",", 
       RowBox[{
        RowBox[{"c", "[", "i_", "]"}], ":>", 
        SubscriptBox["c", "i"]}]}], "}"}], ",", "nice"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.877388939506537*^9, 3.877388949032188*^9}, {
   3.8786378572270403`*^9, 3.878637863818118*^9}, 3.879642703271042*^9, {
   3.879643012238213*^9, 3.879643012690983*^9}, {3.879645027363619*^9, 
   3.8796450276094027`*^9}, {3.8796452459785624`*^9, 3.879645256091978*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"a6f33657-13e1-4cba-8924-27abde55a71c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"SimplifyMono", ",", "SimplifyMonof"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyMono", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "res", "]"}], "===", "Plus"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "res"}], ")"}], "//", "Simplify"}], "//", 
         "Total"}]}], ",", 
       RowBox[{"res", "=", 
        RowBox[{"Simplify", "[", "res", "]"}]}]}], "]"}], ";", "res"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyMonof", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "res", "]"}], "===", "Plus"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "res"}], ")"}], "//", "Simplify"}], "//", 
         "Total"}]}], ",", 
       RowBox[{"res", "=", 
        RowBox[{"FullSimplify", "[", "res", "]"}]}]}], "]"}], ";", "res"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.871038879132368*^9, 3.871038905309572*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"aa256fba-4b71-4d21-a126-4c9a39bb24e9"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Collectj", ",", "Collectjf"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collectj", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"j", "[", "__", "]"}], ",", "Simplify"}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collectjf", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"j", "[", "__", "]"}], ",", "FullSimplify"}], "]"}], 
   "&"}]}]}], "Input",
 CellChangeTimes->{{3.870563255866166*^9, 3.870563259484146*^9}, {
   3.870655391967127*^9, 3.87065539655599*^9}, 3.870655469270833*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"e40cfd72-b14b-4321-ba7f-1664c33f5a0d"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Collectb", ",", "Collectbf"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collectb", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"B", "[", "__", "]"}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collectbf", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"B", "[", "__", "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Factor", "[", "#1", "]"}], "//", "FullSimplify"}], ")"}], 
      "&"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.8705913651404657`*^9, 3.870591383682583*^9}, 
   3.870655472075412*^9, {3.870655517557816*^9, 3.870655550957642*^9}, {
   3.876611424237235*^9, 3.876611424429071*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"5cd03f09-4ddc-4942-95f3-5a69f70271e0"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "Casesdot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Casesdot", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{"f", ",", 
     RowBox[{"dot", "[", "__", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", 
   "Union"}]}]}], "Input",
 CellChangeTimes->{{3.871860800284142*^9, 3.871860849326124*^9}, {
   3.871860880863056*^9, 3.8718609082263327`*^9}, 3.872119829251048*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"4e98a90b-2474-459d-bf7b-ef6fa4a15dbd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"replace", ",", "replaceGen"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"replace", "[", 
    RowBox[{"otherDDMOrder_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"n", "-", "1"}], "]"}]}], ")"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
      RowBox[{"otherDDMOrder", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"replace", "[", "otherDDMOrder_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gg", ",", "ggod"}], "}"}], ",", 
    RowBox[{
     RowBox[{"gg", "=", 
      RowBox[{"p", "/@", "otherDDMOrder"}]}], ";", 
     RowBox[{"ggod", "=", 
      RowBox[{"Sort", "[", "gg", "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", "ggod", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
        RowBox[{
         RowBox[{"(", "gg", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "gg"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"replaceGen", "[", 
   RowBox[{"a_", ",", "otherDDMOrder__"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gg", ",", "ggod"}], "}"}], ",", 
    RowBox[{
     RowBox[{"gg", "=", 
      RowBox[{"a", "/@", 
       RowBox[{"{", "otherDDMOrder", "}"}]}]}], ";", 
     RowBox[{"ggod", "=", 
      RowBox[{"Sort", "[", "gg", "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", "ggod", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
        RowBox[{
         RowBox[{"(", "gg", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "gg"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.853809980519072*^9, 3.8538099861376333`*^9}, {
  3.879635708653821*^9, 3.8796357521749907`*^9}, {3.879635782978458*^9, 
  3.879635786944889*^9}, {3.879635851991856*^9, 3.8796358971405983`*^9}, {
  3.879636430440351*^9, 3.879636476783681*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"4017ebd9-7c0e-4fdc-b498-164358f1042c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "repPrepared", "]"}], "\[IndentingNewLine]", 
 RowBox[{"repPrepared", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "i_", "]"}], ":>", 
     RowBox[{"F", "[", 
      RowBox[{"p", "[", "i", "]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"w", "[", "i_", "]"}], ":>", 
     RowBox[{"w", "[", 
      RowBox[{"p", "[", "i", "]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"p", "[", "j__", "]"}], ":>", 
     RowBox[{"p", "@@", 
      RowBox[{"(", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "j", "}"}]}], ")"}]}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.880168137092037*^9, 3.880168159180973*^9}, {
  3.880168234772587*^9, 3.880168236400927*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"476c402a-2414-4445-89a3-484638728559"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"dotOnshell", ",", "vonshell"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dotOnshell", "[", "n_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "n", "]"}], ",", "f_"}], "]"}], "\[RuleDelayed]", 
     " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", "f"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"p", "[", "n", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", "f"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "0", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"p", "[", "n", "]"}], "]"}], ",", 
       RowBox[{"p", "[", "0", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vonshell", "[", 
   RowBox[{"n_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"v", ",", 
      RowBox[{"p", "[", "i", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"v", ",", 
        RowBox[{"p", "[", "i", "]"}]}], "]"}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"v", ",", 
          RowBox[{"p", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"onshell", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"n", "-", "2"}], "]"}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"n", "-", "1"}], "]"}]}], "]"}], "\[Rule]", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "i", "]"}], ",", 
             RowBox[{"p", "[", "j", "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}], 
      "]"}]}], "+", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"n", "-", "2"}], "]"}], ",", 
      RowBox[{"p", "[", 
       RowBox[{"n", "-", "1"}], "]"}]}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.727163684521564*^9, 3.727163712580194*^9}, 
   3.728198771127473*^9, {3.7282976424483356`*^9, 3.728297678974709*^9}, {
   3.728297723296649*^9, 3.72829773196879*^9}, {3.7492963246076107`*^9, 
   3.749296346599493*^9}, {3.7492969402526007`*^9, 3.749296945367785*^9}, {
   3.756962173926325*^9, 3.756962173952697*^9}, {3.756962214008494*^9, 
   3.756962214036718*^9}, {3.756962285466909*^9, 3.7569622869241734`*^9}, {
   3.756970904201673*^9, 3.7569709322363663`*^9}, {3.759113304523664*^9, 
   3.759113331527665*^9}, {3.759113382631379*^9, 3.759113498024493*^9}, {
   3.759592650632361*^9, 3.759592657996381*^9}, {3.810004273599478*^9, 
   3.8100042908157053`*^9}, {3.813368130768548*^9, 3.813368161218802*^9}, {
   3.8133682014741793`*^9, 3.813368212397605*^9}, {3.813542982230701*^9, 
   3.813543013179331*^9}, {3.813546153285891*^9, 3.813546158120234*^9}, {
   3.813546308456645*^9, 3.8135463101535473`*^9}, {3.8135464926562147`*^9, 
   3.813546546885747*^9}, 3.813546667616501*^9, {3.813547074493762*^9, 
   3.8135470808592043`*^9}, {3.813547399867567*^9, 3.813547441608583*^9}, {
   3.813559656501801*^9, 3.813559667068569*^9}, {3.8135597068041677`*^9, 
   3.813559710282649*^9}, {3.813559768037219*^9, 3.813559779622561*^9}, {
   3.813560124477251*^9, 3.813560131135003*^9}, {3.813560238138142*^9, 
   3.813560266973859*^9}, {3.813560313088909*^9, 3.81356032625429*^9}, {
   3.8135603625794773`*^9, 3.813560379883116*^9}, {3.813562756751007*^9, 
   3.8135627570797586`*^9}, 3.813587217305232*^9, {3.813631538481387*^9, 
   3.813631541035822*^9}, {3.8136340222518473`*^9, 3.813634050518487*^9}, {
   3.843431280830508*^9, 3.843431302343697*^9}, {3.843553240936262*^9, 
   3.8435532494635687`*^9}, {3.843553679143483*^9, 3.843553679792428*^9}, {
   3.843553831340781*^9, 3.843553834894973*^9}, {3.879644003724228*^9, 
   3.8796440660759573`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"95ea9518-c905-4b23-bbdb-aec1d2c138cc"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"sortP", ",", "sortE"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortP", "[", 
   RowBox[{"li_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"li", ",", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"lr", ",", 
       RowBox[{"(", 
        RowBox[{"First", "@", "#"}], ")"}]}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortE", "[", 
   RowBox[{"li_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"li", ",", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"lr", ",", 
       RowBox[{"(", 
        RowBox[{"First", "@@", "#"}], ")"}]}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "repBack", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repBack", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"a_", ",", "i_"}], "]"}], ":>", " ", 
      RowBox[{"a", "[", "i", "]"}]}], ",", 
     RowBox[{"CenterDot", "->", " ", "dot"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.727163681618944*^9, {3.749179480748872*^9, 3.749179491659102*^9}, {
   3.749296395909049*^9, 3.7492964230074463`*^9}, {3.74929688390792*^9, 
   3.74929689475134*^9}, 3.756962173957769*^9, 3.7569622140447397`*^9, {
   3.756962309850726*^9, 3.7569623219178553`*^9}, {3.75697119019627*^9, 
   3.756971194962592*^9}, {3.810006123538918*^9, 3.810006130187482*^9}, {
   3.813643784231852*^9, 3.813643813331348*^9}, 3.841472859500243*^9, {
   3.851849638478299*^9, 3.851849659664133*^9}, {3.854063182750596*^9, 
   3.854063189346609*^9}, 3.879636523684457*^9, {3.879643062374737*^9, 
   3.8796430697726297`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"63b495bf-5f25-42be-b6eb-d92ab9b63958"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "V2spBracket", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V2spBracket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"_", ",", "f_", ",", "m_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"spBracket", "[", 
       RowBox[{
        RowBox[{"spB", "[", "\[Beta]", "]"}], ",", 
        RowBox[{"f", "/.", 
         RowBox[{
          RowBox[{"CircleTimes", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
          "g"}]}], ",", 
        RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"_", ",", "f_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"spBracket", "[", 
       RowBox[{
        RowBox[{"spB", "[", "\[Beta]", "]"}], ",", 
        RowBox[{"f", "/.", 
         RowBox[{
          RowBox[{"CircleTimes", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
          "g"}]}], ",", 
        RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.849943435749509*^9, 3.8499434443014603`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"a3a4be0d-bc29-45f6-b509-80aa9b35e746"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"cyclePermute", ",", "cyclePermuteSum"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclePermute", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "list", "}"}], ",", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Permute", "[", " ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "}"}], "]"}]}], "]"}]}],
      ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"list", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclePermuteSum", "[", 
   RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fsum", ",", 
      RowBox[{"g", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "f"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"cyclePermute", "[", "n", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", " ", 
     RowBox[{"fsum", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{3.7595925973087378`*^9},
 CellLabel->"In[51]:=",ExpressionUUID->"db32a883-9994-4512-8a32-712ed53230c6"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"leadingSeries", ",", "LdTerm"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leadingSeries", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Normal", "[", 
   RowBox[{
    RowBox[{"expr", "/.", 
     RowBox[{"x", "\[Rule]", 
      RowBox[{"Series", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "1"}], "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"Verbatim", "[", "SeriesData", "]"}], "[", 
      RowBox[{"a__", ",", 
       RowBox[{"{", 
        RowBox[{"b_", ",", "___"}], "}"}], ",", "c__"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", "b", "}"}], ",", "c"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"LdTerm", "[", 
   RowBox[{"f_", ",", "var_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"leadingSeries", "[", 
    RowBox[{"f", ",", 
     RowBox[{"{", 
      RowBox[{"var", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", 
   "Normal"}]}]}], "Input",
 CellLabel->"In[54]:=",ExpressionUUID->"16d45bd6-b4a8-4347-8488-3ed2148e2ae8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expand Tensors", "Subsection",
 CellChangeTimes->{{3.871715923985506*^9, 
  3.8717159306720257`*^9}},ExpressionUUID->"c528d33f-d8eb-47b9-a0dd-\
af5e6f1888af"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"expandTdot", ",", "expandT"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTdot", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"F", "[", "i_", "]"}], "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "[", "a", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "i", "]"}], "[", "b", "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "i", "]"}], "[", "a", "]"}], 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"W", "[", "i_", "]"}], "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "[", "a", "]"}], 
         RowBox[{
          RowBox[{"v", "[", "i", "]"}], "[", "b", "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "i", "]"}], "[", "a", "]"}], 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}]}], "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"V", "[", "i___", "]"}], "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", "0", "]"}], "[", "a", "]"}], 
       RowBox[{
        RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}], ")"}], "//", 
   "contract"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandT", "[", "f_", "]"}], ":=", " ", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"expandTdot", "[", 
     RowBox[{"dot", "[", "g", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"expandTensorGen", ",", "expandF"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g__", "]"}], ":>", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandF", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "id", "]"}], "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "b", "]"}]}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "b", 
       "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandF", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "id_", "]"}], "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "b", "]"}]}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "b", "]"}]}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8519988490005493`*^9, 3.8519988586312313`*^9}, {
  3.852266080976235*^9, 3.852266083544794*^9}, {3.8522661271732883`*^9, 
  3.8522661315239162`*^9}, {3.8522662312904997`*^9, 3.8522662509717417`*^9}, {
  3.852342321299981*^9, 3.852342321961708*^9}, {3.852342379535592*^9, 
  3.852342380584991*^9}, {3.871691418979636*^9, 3.871691419907322*^9}, {
  3.87169145976577*^9, 3.871691475455221*^9}, {3.871691506816244*^9, 
  3.8716916564787827`*^9}, {3.871691706084654*^9, 3.871691733103662*^9}, {
  3.8717067770260687`*^9, 3.871706787951022*^9}, {3.871706897332698*^9, 
  3.871706919266697*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"8ba90879-f9a7-46f3-84f1-d104f8e60d30"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandFDirect", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFDirect", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"p", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "b"}], "]"}]}], "-", " ", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "id", "]"}], ",", "b"}], 
       "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFDirect", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "//.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"p", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "b"}], "]"}]}], "-", " ", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "id", "]"}], ",", "b"}], "]"}]}]}]}]}]}]}], "Input",\

 CellChangeTimes->{{3.876777766242668*^9, 3.87677794338896*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"3f54f243-2649-4daf-8533-7583ab797d2f"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "dressdot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dressdot", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{"res", "=", 
     RowBox[{
      RowBox[{"f", "/.", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"g_", ",", 
          RowBox[{"\[Epsilon]", "[", "id_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"lI", "[", 
           RowBox[{"0", ",", "id"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id_", "]"}], ",", "g_"}], "]"}], ":>", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"lI", "[", 
          RowBox[{"0", ",", "id"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "dressdotGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dressdotGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], ";", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//", "dressdot"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{
  3.872034945418346*^9, {3.8720349907917633`*^9, 3.872034993209223*^9}, {
   3.872036261541153*^9, 3.872036291395546*^9}, {3.872036858716271*^9, 
   3.872036870110409*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"b21d6b70-b445-4ba6-b097-a7cebb2c2297"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//", "dressdot"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g__", "]"}], ":>", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.872034492365653*^9, 3.872034567286909*^9}, {
  3.8720347035629787`*^9, 3.872034758097516*^9}, {3.8720350050883617`*^9, 
  3.87203501817365*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"75282d94-b2ec-4bbc-be5f-0c2e506993d5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "FTensorReduce", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduce", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "2", "]"}], ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", 
           RowBox[{"v", "[", "2", "]"}]}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "2", "]"}], ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{"b", "=!=", 
      RowBox[{"v", "[", "2", "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduce", "[", 
   RowBox[{"f_", ",", "v2_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{"v2", ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "v2"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"v2", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", "=!=", "v2"}], "&&", 
       RowBox[{"a", "=!=", "v2"}]}], ")"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8710113197696133`*^9, 3.8710113205510817`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"3ed81259-0a5f-4929-a56c-1608585fb04c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "FTensorReduceG", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduceG", "[", 
   RowBox[{"f_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "2", "]"}], ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", 
           RowBox[{"v", "[", "2", "]"}]}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "2", "]"}], ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "a", "}"}], "]"}], ">=", "2"}], "&&", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "b", "}"}], "]"}], ">=", 
       "2"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduceG", "[", 
   RowBox[{"f_", ",", "i_", ",", "v2_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{"v2", ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "v2"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"v2", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "a", "}"}], "]"}], ">=", "2"}], "&&", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "b", "}"}], "]"}], ">=", "2"}]}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8766049144819403`*^9, 3.8766049514374*^9}, {
  3.880267481810541*^9, 3.880267509373275*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"15e46d7d-06a1-4c52-b273-8fdbddadcddd"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandTr", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTr", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lt", "=", 
         RowBox[{"Length", "[", "f", "]"}]}], ",", "ts"}], "}"}], ",", 
      RowBox[{"ts", "=", 
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"tr", "[", "g___", "]"}], ":>", " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "1"}], "]"}], ",", "g", ",", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "1"}], "]"}]}], "]"}]}]}]}]}], "]"}], "//", 
    "expandGen"}], "//", "expandF"}]}]}], "Input",
 CellChangeTimes->{{3.854191039354165*^9, 3.854191039594904*^9}, {
  3.854191096585668*^9, 3.8541911346819267`*^9}, {3.854191258960875*^9, 
  3.8541912891639442`*^9}, {3.854191345530801*^9, 3.8541913487274323`*^9}, {
  3.8541914272027063`*^9, 3.854191501571187*^9}, {3.854191759253392*^9, 
  3.8541917851217737`*^9}, {3.8541918354435787`*^9, 3.854191903651122*^9}, {
  3.8541921068331747`*^9, 3.854192117283308*^9}, {3.8765378395707912`*^9, 
  3.876537841794339*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"37a7230a-cf85-40af-8127-779eeb703e02"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "tr2dot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr2dot", "[", "f_tr", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"last", ",", "vlist", ",", "plast", ",", "v1", ",", "v2"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"last", "=", 
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", 
     RowBox[{"plast", "=", 
      RowBox[{"p", "@@", "last"}]}], ";", 
     RowBox[{"vlist", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@", "f"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "plast", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "last", "}"}], ",", 
        RowBox[{"{", "v", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "v", "}"}], ",", 
        RowBox[{"{", "last", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "plast", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"dot", "@@", "v1"}], 
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", "plast"}], "]"}]], "+", 
      FractionBox[
       RowBox[{"dot", "@@", "v2"}], 
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", "plast"}], "]"}]]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr2dot", "[", 
   RowBox[{"f_tr", ",", "a_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"last", ",", "vlist", ",", "plast", ",", "v1", ",", "v2"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"last", "=", 
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", 
     RowBox[{"plast", "=", 
      RowBox[{"p", "@@", "last"}]}], ";", 
     RowBox[{"vlist", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@", "f"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "plast", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "last", "}"}], ",", 
        RowBox[{"{", "a", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "last", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "plast", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"dot", "@@", "v1"}], 
       RowBox[{"dot", "[", 
        RowBox[{"a", ",", "plast"}], "]"}]], "+", 
      FractionBox[
       RowBox[{"dot", "@@", "v2"}], 
       RowBox[{"dot", "[", 
        RowBox[{"a", ",", "plast"}], "]"}]]}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[81]:=",ExpressionUUID->"86386577-80ea-474c-9d71-cb6827863068"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "antiSymrep", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"antiSymrep", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Signature", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "<", "0"}]}]}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", 
        RowBox[{"F", "[", "j_", "]"}], ",", "b_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"b", ",", 
         RowBox[{"F", "[", "j", "]"}], ",", 
         RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}], "/;", 
       RowBox[{"i", ">", "j"}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.853462108697447*^9, 3.853462142837044*^9}, {
  3.8534646323189697`*^9, 3.8534646409716263`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"5d9efe21-4964-4b4f-8173-8f9da05b2cf0"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "CombWithRep", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombWithRep", "[", 
   RowBox[{"ls_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"List", "@@", 
     RowBox[{"(", 
      RowBox[{"Diamond", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Total", "[", "ls", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ")"}]}], ")"}], "/.", 
   RowBox[{"Diamond", "->", " ", "List"}]}]}]}], "Input",
 CellLabel->"In[86]:=",ExpressionUUID->"dcfc64fa-580c-4dd3-b67b-203252d968ff"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "minSets", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minSets", "[", "list_List", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "=", 
       RowBox[{"Union", "@", "list"}]}], ",", "r"}], "}"}], ",", 
    RowBox[{"Pick", "[", 
     RowBox[{"u", ",", 
      RowBox[{"Subtract", "[", 
       RowBox[{
        RowBox[{"BitAnd", "@@@", 
         RowBox[{"Replace", "[", 
          RowBox[{"u", ",", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"g", "=", 
               RowBox[{"GatherBy", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Join", "@@", "u"}], ",", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"ConstantArray", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r", "=", 
                    RowBox[{"2", "^", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Length", "@", "u"}], "-", "1"}]}], "]"}]}]}], 
                    ",", 
                    RowBox[{"Length", "/@", "u"}]}], "}"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "First"}], "]"}]}], "}"}], ",", 
             RowBox[{"Dispatch", "@", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"g", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "->", 
                RowBox[{"Total", "[", 
                 RowBox[{
                  RowBox[{"g", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], ",", 
                  
                  RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "r"}], "]"}], ",", "0"}], 
     "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[88]:=",ExpressionUUID->"677c8a38-5351-4f01-ae82-959e2da73f35"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandTensorFi", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorFi", "[", 
   RowBox[{"f_dot", ",", "id_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"a__", ",", 
       RowBox[{"F", "[", "id", "]"}], ",", "g___", ",", 
       RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], ":>", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "1", ",", "1"}], "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "1", ",", "2"}], "]"}], ",", "g", ",", 
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "2", ",", "1"}], "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "2", ",", "2"}], "]"}], ",", "b"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "2"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "2"}], "]"}], "]"}]}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "2"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}]}]}], 
   "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], ":>", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"a", ",", 
       RowBox[{"lI", "[", 
        RowBox[{"id", ",", "1"}], "]"}]}], "]"}], 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"lI", "[", 
        RowBox[{"id", ",", "2"}], "]"}], ",", "b"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"p", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "1"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "2"}], "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "1"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"p", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "2"}], "]"}], "]"}]}]}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "expandTensorFiGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorFiGen", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h__"}], "]"}], ",", "2"}], 
           "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"g", ",", 
               RowBox[{"F", "[", "id", "]"}], ",", "h"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h__"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h1__"}], "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h1"}], "]"}]}], "]"}]}]}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", "2"}], 
           "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"g", ",", 
               RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",",
             "2"}], "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}], ":>", 
          
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}], ":>", 
          
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
            
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1_"}], "]"}]}], 
           "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1"}], "]"}]}], 
           "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1_"}], "]"}]}], 
           "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
            
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1"}], "]"}]}], 
           "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"res", "/.", 
          RowBox[{
           RowBox[{"dot", "[", "g__", "]"}], ":>", 
           RowBox[{"expandTensorFi", "[", 
            RowBox[{
             RowBox[{"dot", "[", "g", "]"}], ",", "id"}], "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{"g_", ",", 
            RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ":>", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"lI", "[", 
             RowBox[{"0", ",", "id"}], "]"}], "]"}], 
           RowBox[{
            RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
            RowBox[{"lI", "[", 
             RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "id"}], "]"}], "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8717101857556257`*^9, 3.871710247171233*^9}, {
   3.871710344490424*^9, 3.871710464250885*^9}, {3.871710514216856*^9, 
   3.871710535067227*^9}, {3.871710577772479*^9, 3.871710619653611*^9}, {
   3.87171070099017*^9, 3.871710793817266*^9}, {3.8717110547727757`*^9, 
   3.871711098694851*^9}, {3.871711566802866*^9, 3.8717116001589727`*^9}, {
   3.8717925794231157`*^9, 3.8717926279638968`*^9}, {3.871792658993463*^9, 
   3.871792659631276*^9}, 3.871792836017084*^9, {3.871792881937099*^9, 
   3.871792936440737*^9}, {3.871793027757831*^9, 3.871793027984799*^9}, {
   3.8717930770034943`*^9, 3.8717931563424873`*^9}, {3.871793189683238*^9, 
   3.871793219777211*^9}, {3.871794218005933*^9, 3.8717942969355288`*^9}, {
   3.871794593480941*^9, 3.871794608503077*^9}, {3.871794745604311*^9, 
   3.87179476760977*^9}, {3.871794877507155*^9, 3.871794880713606*^9}, {
   3.871794991131771*^9, 3.87179509392428*^9}, {3.8717951470684958`*^9, 
   3.871795182954617*^9}, {3.8718603028865423`*^9, 3.871860327016007*^9}, {
   3.871860459558563*^9, 3.871860475007077*^9}, {3.871878859716531*^9, 
   3.871878883200115*^9}, {3.871878943674459*^9, 3.8718789878517*^9}, {
   3.871879040687913*^9, 3.871879042718019*^9}, {3.8718797681531343`*^9, 
   3.871879772859611*^9}, {3.8718798541089087`*^9, 3.871880037163097*^9}, {
   3.8765284853468723`*^9, 3.8765285056137733`*^9}, {3.876528614447425*^9, 
   3.8765286203250027`*^9}, {3.876529061202283*^9, 3.876529118675256*^9}, {
   3.876535688731642*^9, 3.876535689308138*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"7a34d1ed-c095-4938-9235-1e63123ea8dd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "GlueAmp2", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Slow", " ", "function", " ", "for", " ", "testing"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp2", "[", 
   RowBox[{"f__", ",", "pi_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"Times", "[", "f", "]"}], "/.", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"g_", ",", "vv_", ",", "ps_"}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "/.", 
           RowBox[{"v", "->", "vv"}]}], "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}], 
           "]"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"res", "//", "expandGen"}], "//", 
         RowBox[{
          RowBox[{"expandF", "[", 
           RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", 
        RowBox[{
         RowBox[{"expandF", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b1"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"DD", "-", "2"}]], 
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "a2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}], "//", 
       "contractAnti"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.871712600587709*^9, 3.871712670352553*^9}, {
  3.871712848705008*^9, 3.8717128512044077`*^9}, {3.8717156142755423`*^9, 
  3.871715631992737*^9}, {3.871945244409588*^9, 3.871945272183694*^9}, {
  3.872034874753574*^9, 3.872034875714731*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"025fe46f-98bd-4bd4-8417-808da771bab6"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GlueAmp3", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp3", "[", 
   RowBox[{"f__", ",", "pi_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"Times", "[", "f", "]"}], "/.", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"g_", ",", "vv_", ",", "ps_"}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "/.", 
           RowBox[{"v", "->", "vv"}]}], "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}], 
           "]"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "/.", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
        
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "b1"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "b2"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
           RowBox[{
            FractionBox["2", 
             RowBox[{"DD", "-", "2"}]], 
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "a2"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.87194534060808*^9, 3.871945346058714*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"85db6638-7940-4c54-88f8-d8cbc248dc32"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GlueAmp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp", "[", 
   RowBox[{"f__", ",", "pi_li"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Times", "[", "f", "]"}], "/.", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"g_", ",", "vv_", ",", "ps_"}], "]"}], ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", "/.", 
            RowBox[{"v", "->", "vv"}]}], "/.", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p", "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}],
             "]"}]}], ")"}]}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b1"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"DD", "-", "2"}]], 
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "a2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}], "//", 
       "contractAnti"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.717672845976037*^9, 3.717672889169771*^9}, {
   3.717674925531893*^9, 3.71767495835476*^9}, {3.717675063695549*^9, 
   3.717675066478118*^9}, {3.717675300930599*^9, 3.7176753267138968`*^9}, {
   3.7176753870934343`*^9, 3.717675403057289*^9}, {3.7176754381874647`*^9, 
   3.71767547431498*^9}, 3.717675660783152*^9, {3.717736602639456*^9, 
   3.7177366242846107`*^9}, {3.717737468069676*^9, 3.717737480653091*^9}, {
   3.717750828787468*^9, 3.717750872340436*^9}, {3.718860636025526*^9, 
   3.718860640412352*^9}, {3.7188607903613377`*^9, 3.718860795560849*^9}, 
   3.71886086446344*^9, {3.718860948446919*^9, 3.718860951595491*^9}, 
   3.718860984899868*^9, {3.721238842235695*^9, 3.721238843744174*^9}, {
   3.721410336076936*^9, 3.7214103369702473`*^9}, {3.721412975267428*^9, 
   3.721412988890263*^9}, {3.72141323618769*^9, 3.7214132364838457`*^9}, 
   3.7214147264125347`*^9, {3.722247891811057*^9, 3.722247901391345*^9}, {
   3.727163630705885*^9, 3.727163679035369*^9}, {3.7271813171878366`*^9, 
   3.727181351523305*^9}, {3.727181477010126*^9, 3.727181501954378*^9}, {
   3.7569617666765738`*^9, 3.756961766784175*^9}, {3.756961870648288*^9, 
   3.756961949579342*^9}, {3.756962094598337*^9, 3.7569621098574553`*^9}, {
   3.756962167672611*^9, 3.7569621739207697`*^9}, {3.7569622139938307`*^9, 
   3.7569622426119537`*^9}, 3.756962373458827*^9, {3.809660362743723*^9, 
   3.809660418070587*^9}, {3.8096614085618067`*^9, 3.809661412551626*^9}, {
   3.809662049147789*^9, 3.809662101747892*^9}, {3.8096621462298317`*^9, 
   3.809662152164967*^9}, {3.809695613944919*^9, 3.809695685233942*^9}, 
   3.809695754647512*^9, {3.809695795605771*^9, 3.809695832316655*^9}, {
   3.809695960033867*^9, 3.809696106429303*^9}, {3.809696168645002*^9, 
   3.8096962031609497`*^9}, {3.80969630311021*^9, 3.809696333870982*^9}, {
   3.809696500996005*^9, 3.809696552942379*^9}, {3.8096965843172007`*^9, 
   3.809696642216886*^9}, {3.80969668037805*^9, 3.809696725452177*^9}, {
   3.8096968004483547`*^9, 3.809696937098598*^9}, {3.8096969918981867`*^9, 
   3.8096970974956913`*^9}, {3.809697150172176*^9, 3.809697151784438*^9}, {
   3.809851404069126*^9, 3.8098514312721767`*^9}, {3.8098515608428*^9, 
   3.8098515619391623`*^9}, {3.81000416196408*^9, 3.81000419966461*^9}, {
   3.810004329672138*^9, 3.810004330140016*^9}, {3.810012567227653*^9, 
   3.8100125857543917`*^9}, {3.849077219402678*^9, 3.8490772205862703`*^9}, {
   3.849077274201914*^9, 3.849077275031169*^9}, {3.8499313915236273`*^9, 
   3.84993139457652*^9}, {3.849936499751693*^9, 3.849936522953876*^9}, {
   3.8500933864282*^9, 3.850093395755972*^9}, {3.8500936471419897`*^9, 
   3.85009368571201*^9}, 3.8518569570609493`*^9, 3.853202602524168*^9, 
   3.853215130512108*^9, 3.857451044110569*^9, 3.871297285245735*^9, {
   3.871619444103547*^9, 3.871619451260944*^9}, {3.871619490117971*^9, 
   3.871619521315403*^9}, {3.871619619378182*^9, 3.87161962417244*^9}, {
   3.8716196556270733`*^9, 3.871619681596793*^9}, {3.871619831706586*^9, 
   3.871619864427882*^9}, {3.8716213205601892`*^9, 3.871621333226293*^9}, {
   3.871625017999157*^9, 3.871625241366728*^9}, {3.871625291216332*^9, 
   3.871625359241075*^9}, {3.871625493107828*^9, 3.8716254955113497`*^9}, {
   3.8716255615364437`*^9, 3.871625564022999*^9}, 3.871625841369969*^9, {
   3.87162607082874*^9, 3.871626075743566*^9}, {3.8716899594033813`*^9, 
   3.8716899600539207`*^9}, {3.8716900784125357`*^9, 
   3.8716900789351377`*^9}, {3.871705590182193*^9, 3.871705593089178*^9}, {
   3.871705721469871*^9, 3.871705813886736*^9}, {3.871705853265871*^9, 
   3.8717058662856207`*^9}, {3.8717059035408707`*^9, 3.871706011684908*^9}, 
   3.871706045343543*^9, {3.871706484816691*^9, 3.87170652555105*^9}, 
   3.8717069814938707`*^9, {3.871707150080432*^9, 3.871707168903172*^9}, {
   3.871707495653973*^9, 3.871707602306806*^9}, {3.8717076664684687`*^9, 
   3.871707692027851*^9}, {3.87170782927689*^9, 3.871707831107004*^9}, {
   3.8717078660880747`*^9, 3.871707868174891*^9}, 3.8717079100251617`*^9, 
   3.871708016362279*^9, 3.871708514321631*^9, {3.871709414281816*^9, 
   3.8717094266664257`*^9}, {3.8717108986134253`*^9, 3.871710934064623*^9}, 
   3.871711118911961*^9, 3.8717113235660048`*^9, 3.871711699746305*^9, {
   3.871711841537026*^9, 3.871711852394979*^9}, {3.871711988334196*^9, 
   3.871712020526985*^9}, {3.871715537622472*^9, 3.871715540368991*^9}, {
   3.872118897251507*^9, 3.872118897481187*^9}, {3.876454167099728*^9, 
   3.876454170049754*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"398da8e0-fbb6-431b-b938-13c4d298238b"]
}, Closed]],

Cell[CellGroupData[{

Cell["MonomialTransformation", "Subsection",
 CellChangeTimes->{{3.871716025388597*^9, 
  3.871716031302944*^9}},ExpressionUUID->"a975fd09-0582-429c-bebe-\
89aa18c44e6e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Mono2List", ",", "deg", ",", "degDotp"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"f_", ",", "var_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"num", "=", 
       RowBox[{"Numerator", "[", "f", "]"}]}], ",", 
      RowBox[{"den", "=", 
       RowBox[{"Denominator", "[", "f", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Plus", "@@@", 
          RowBox[{
           RowBox[{"CoefficientRules", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
       RowBox[{"(", "num", ")"}]}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Plus", "@@@", 
          RowBox[{
           RowBox[{"CoefficientRules", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
       RowBox[{"(", "den", ")"}]}], ")"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"degDotp", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"deg", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a_p", ",", "b_p"}], "]"}], ":>", "x"}]}], "/.", 
       RowBox[{
        RowBox[{"dot", "[", "g__", "]"}], ":>", " ", "1"}]}], " ", ",", 
      RowBox[{"{", "x", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mono2List", "[", 
   RowBox[{"f_", ",", "dimDen_"}], "]"}], ":=", 
  RowBox[{"FF", "[", 
   RowBox[{"1", ",", 
    RowBox[{"-", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"deg", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], "}"}]}], "]"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"ii", ",", "dimDen"}], "}"}]}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Mono2List", "[", 
   RowBox[{"f_", ",", "dimDen_List"}], "]"}], ":=", 
  RowBox[{"FF", "[", 
   RowBox[{"1", ",", 
    RowBox[{"-", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"deg", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"dimDen", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "dimDen"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.871716074820694*^9, 3.8717160840867434`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"9e5a9a6e-6080-484e-aa70-e86924b7da10"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GetDenominatorFun", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetDenominatorFun", "[", 
   RowBox[{"h_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "alldeno", "}"}], ",", 
    RowBox[{
     RowBox[{"alldeno", "=", 
      RowBox[{"(", 
       RowBox[{"List", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"auxilaryVariables", "*", 
           RowBox[{"Denominator", "[", "h", "]"}]}], "/.", 
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{"f_", ",", "n_"}], "]"}], ":>", " ", "f"}]}], ")"}]}], 
       ")"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"alldeno", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "//", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"dot", "[", "__", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}], 
            ",", "vars"}], "]"}], "==", 
          RowBox[{"{", "}"}]}], ",", "Nothing", ",", 
         RowBox[{"alldeno", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "alldeno"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "GenIBPdotList", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenIBPdotList", "[", 
   RowBox[{"h_", ",", "vars_List", ",", "numeratordots_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pplist", ",", "he"}], "}"}], ",", 
    RowBox[{
     RowBox[{"he", "=", 
      RowBox[{"h", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"GetDenominatorFun", "[", 
          RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"List", "@@", "he"}], ")"}]}], "//", "Union"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{"minSets", "[", "pplist", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"pplist", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", "pplist"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"pplist", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], ",", "numeratordots"}], "]"}], "//",
          "DeleteDuplicates"}], "//", "Union"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenIBPdotList", "[", 
   RowBox[{"h_", ",", "vars_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pplist", ",", "he"}], "}"}], ",", 
    RowBox[{
     RowBox[{"he", "=", 
      RowBox[{"h", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"GetDenominatorFun", "[", 
          RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"List", "@@", "he"}], ")"}]}], "//", "Union"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{"minSets", "[", "pplist", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"pplist", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], ",", 
         RowBox[{"Complement", "[", 
          RowBox[{"vars", ",", 
           RowBox[{
            RowBox[{"pplist", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "//", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"#", ",", 
               RowBox[{"dot", "[", "__", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}]}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"mono2j", ",", "mono2B"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2j", "[", 
   RowBox[{"g_", ",", "pplist_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"propgatorlist", "=", 
      RowBox[{"GetDenominatorFun", "[", 
       RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pid", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"SubsetQ", "[", 
             RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
           "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
       "First"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"pplist", "[", 
            RowBox[{"[", "pid", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pplist", "[", 
           RowBox[{"[", "pid", "]"}], "]"}], "==", "dds"}], ",", "vars"}], 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"j", "[", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<gr\>\"", "<>", 
              RowBox[{"ToString", "[", "pid", "]"}]}], "]"}], ",", "f"}], 
           "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2j", "[", 
   RowBox[{"g_", ",", "pplist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"propgatorlist", "=", 
        RowBox[{"GetDenominatorFun", "[", 
         RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pid", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
             "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
         "First"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"pplist", "==", "dds"}], ",", "pplist"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"B", "@@", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"{", "f", "}"}]}], ")"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2B", "[", 
   RowBox[{"g_", ",", "pplist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"propgatorlist", "=", 
        RowBox[{"GetDenominatorFun", "[", 
         RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pid", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
             "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
         "First"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"pplist", ",", "dds"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"B", "@@", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"{", "f", "}"}]}], ")"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.87013929658813*^9, 3.87013929709615*^9}, 
   3.87015456888785*^9, {3.870155204422731*^9, 3.870155217666298*^9}, {
   3.8701553410718737`*^9, 3.87015535134295*^9}, 3.870155401400276*^9, {
   3.8704311873876657`*^9, 3.870431268553248*^9}, {3.8705917169072323`*^9, 
   3.870591717418168*^9}, {3.876610362699594*^9, 3.8766104319483433`*^9}, {
   3.876610942764016*^9, 3.876610989180686*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"85381c0e-28b0-4e61-bcdf-b197d6083f5e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Levi-Civita Expansion", "Subsection",
 CellChangeTimes->{{3.8768839877249594`*^9, 
  3.8768840068850174`*^9}},ExpressionUUID->"1964b7a2-060f-4add-9c33-\
5f6644c35245"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "etaMatrix", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"etaMatrix", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_", ",", 
     "x7_", ",", "x8_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x8"}], "]"}]}], "}"}]}], "}"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.87742287808566*^9, 3.8774229129952793`*^9}, {
  3.8774230721070642`*^9, 3.8774230801424713`*^9}, {3.877423501400942*^9, 
  3.877423508889386*^9}, {3.877423973554997*^9, 3.8774239752112007`*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"79babd0c-3512-4340-8232-e83ba8c12033"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandFS", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFS", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"f", "//", "expandFDirect"}], ")"}], "/.", 
     RowBox[{
      RowBox[{"dot", "[", "g__", "]"}], ":>", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dot", "[", "g", "]"}], "//", "expandGen"}], ")"}], "/.", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"S", "[", "0", "]"}], "[", 
            RowBox[{"aa_", ",", "b_"}], "]"}], " ", 
           RowBox[{
            RowBox[{"S", "[", "0", "]"}], "[", 
            RowBox[{"c_", ",", "d_"}], "]"}]}], ":>", 
          RowBox[{"-", 
           RowBox[{"Det", "[", 
            RowBox[{"etaMatrix", "[", 
             RowBox[{"aa", ",", "b", ",", "c", ",", "d", ",", 
              RowBox[{"v", "[", "1", "]"}], ",", "a", ",", 
              RowBox[{"v", "[", "1", "]"}], ",", "a"}], "]"}], "]"}]}]}]}], "//",
         "contractAnti"}], ")"}]}]}], "//.", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"g1__", ",", 
        RowBox[{"S", "[", "0", "]"}], ",", "g2__"}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{"g3__", ",", 
        RowBox[{"S", "[", "0", "]"}], ",", "g4__"}], "]"}]}], ":>", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"g1", ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "g2"}], "]"}], 
           RowBox[{"dot", "[", 
            RowBox[{"g3", ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "g4"}], "]"}]}], "//", 
          "expandGen"}], ")"}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"S", "[", "0", "]"}], "[", 
           RowBox[{"aa_", ",", "b_"}], "]"}], " ", 
          RowBox[{
           RowBox[{"S", "[", "0", "]"}], "[", 
           RowBox[{"c_", ",", "d_"}], "]"}]}], ":>", 
         RowBox[{"-", 
          RowBox[{"Det", "[", 
           RowBox[{"etaMatrix", "[", 
            RowBox[{"aa", ",", "b", ",", "c", ",", "d", ",", 
             RowBox[{"v", "[", "1", "]"}], ",", "a", ",", 
             RowBox[{"v", "[", "1", "]"}], ",", "a"}], "]"}], "]"}]}]}]}], "//",
        "contractAnti"}], ")"}]}]}], "//.", 
   RowBox[{
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"g1__", ",", 
        RowBox[{"S", "[", "0", "]"}], ",", "g2__"}], "]"}], ",", "od_"}], 
     "]"}], ":>", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"g1", ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "g2"}], "]"}], 
           RowBox[{"dot", "[", 
            RowBox[{"g1", ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "g2"}], "]"}]}], "//", 
          "expandGen"}], ")"}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"S", "[", "0", "]"}], "[", 
           RowBox[{"aa_", ",", "b_"}], "]"}], " ", 
          RowBox[{
           RowBox[{"S", "[", "0", "]"}], "[", 
           RowBox[{"c_", ",", "d_"}], "]"}]}], ":>", 
         RowBox[{"-", 
          RowBox[{"Det", "[", 
           RowBox[{"etaMatrix", "[", 
            RowBox[{"aa", ",", "b", ",", "c", ",", "d", ",", 
             RowBox[{"v", "[", "1", "]"}], ",", "a", ",", 
             RowBox[{"v", "[", "1", "]"}], ",", "a"}], "]"}], "]"}]}]}]}], "//",
        "contractAnti"}], ")"}], "*", 
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"g1", ",", 
         RowBox[{"S", "[", "0", "]"}], ",", "g2"}], "]"}], ",", 
       RowBox[{"od", "-", "2"}]}], "]"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8774239821267138`*^9, 3.877424021716002*^9}, {
  3.87742429888728*^9, 3.877424396304152*^9}, {3.8774246172079277`*^9, 
  3.8774246345014153`*^9}, {3.8794106015020723`*^9, 3.8794107791601*^9}, {
  3.8794640107658367`*^9, 3.8794640635188932`*^9}, {3.879464103579764*^9, 
  3.879464155139634*^9}, {3.879642746561934*^9, 3.8796428220339947`*^9}, {
  3.8796436430854807`*^9, 3.879643650294845*^9}, {3.8796448720658207`*^9, 
  3.8796449046802807`*^9}, {3.8796451320826674`*^9, 3.8796451320851593`*^9}, {
  3.8815341340246067`*^9, 3.88153415559826*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"c9ebaf50-9b3d-48f6-890b-98dde6d47adb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Spin Ansatz", "Subsection",
 CellChangeTimes->{{3.879499517991712*^9, 
  3.879499521914666*^9}},ExpressionUUID->"40cf7ca5-731b-49c8-9c05-\
0684b3dc1ba2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "KSetPartitions", ",", "SetPartitions", ",", "KSetPartitionsEmpty"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"0", ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KSetPartitions", "[", 
    RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"{", "}"}], " ", "/;", " ", 
    RowBox[{"k", " ", ">", " ", 
     RowBox[{"Length", "[", "s", "]"}]}]}]}], " "}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", "#1", "}"}], " ", "&"}], " ", ")"}], " ", "/@", " ", 
     "s"}], "}"}], " ", "/;", " ", 
   RowBox[{"k", " ", "===", " ", 
    RowBox[{"Length", "[", "s", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$RecursionLimit", " ", "=", " ", "Infinity"}], ",", " ", 
       "j"}], "}"}], ",", " ", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{"#1", ",", " ", 
            RowBox[{"{", 
             RowBox[{"First", "[", "s", "]"}], "}"}]}], "]"}], " ", "&"}], 
         " ", ")"}], " ", "/@", " ", 
        RowBox[{"KSetPartitions", "[", 
         RowBox[{
          RowBox[{"Rest", "[", "s", "]"}], ",", " ", 
          RowBox[{"k", " ", "-", " ", "1"}]}], "]"}]}], ",", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"Delete", "[", 
                 RowBox[{"#1", ",", " ", "j"}], "]"}], ",", " ", 
                RowBox[{"Prepend", "[", 
                 RowBox[{
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
                  RowBox[{"s", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", 
                RowBox[{"Length", "[", "#1", "]"}]}], "}"}]}], "]"}], " ", 
            "&"}], " ", ")"}], " ", "/@", " ", 
          RowBox[{"KSetPartitions", "[", 
           RowBox[{
            RowBox[{"Rest", "[", "s", "]"}], ",", " ", "k"}], "]"}]}], ",", 
         " ", "1"}], "]"}]}], "]"}]}], "]"}], " ", "/;", " ", 
   RowBox[{
    RowBox[{"k", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"k", " ", "<", " ", 
     RowBox[{"Length", "[", "s", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"0", ",", " ", 
    RowBox[{
     RowBox[{"(", "k_Integer", ")"}], "?", "Positive"}]}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], ",", " ", "0"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], ",", " ", 
    RowBox[{
     RowBox[{"(", "k_Integer", ")"}], "?", "Positive"}]}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{"Range", "[", "n", "]"}], ",", " ", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SetPartitiona", " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", 
   RowBox[{"{", "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", "s_List", "]"}], " ", ":=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"KSetPartitions", "[", 
       RowBox[{"s", ",", " ", "i"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "2", ",", 
        RowBox[{
         RowBox[{"Length", "[", "s", "]"}], "-", "2"}]}], "}"}]}], "]"}], ",",
     " ", "1"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", 
   RowBox[{
    RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], "]"}], " ", ":=", " ", 
  RowBox[{"SetPartitions", "[", 
   RowBox[{"Range", "[", "n", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KSetPartitionsEmpty", "[", 
    RowBox[{"s_List", ",", "k_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"app", ",", "KMod"}], "}"}], ",", 
     RowBox[{
      RowBox[{"app", "=", 
       RowBox[{"KSetPartitions", "[", 
        RowBox[{"s", ",", "k"}], "]"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KMod", "=", 
          RowBox[{"KSetPartitions", "[", 
           RowBox[{"s", ",", "q"}], "]"}]}], ";", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"KMod", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"k", "-", "q"}]}], "}"}]}], "]"}], ";", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"app", ",", 
              RowBox[{"KMod", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"KSetPartitions", "[", 
               RowBox[{"s", ",", "q"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "1", ",", 
          RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"Return", "[", "app", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.876811307266223*^9, 3.876811357406602*^9}, {
   3.876814773296413*^9, 3.876814814709012*^9}, {3.8768150847160673`*^9, 
   3.876815104266962*^9}, 3.879645132099728*^9},
 CellLabel->
  "In[118]:=",ExpressionUUID->"3f771a88-a22c-4ad4-98c4-bf799257a288"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monomialsAnsSingle", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monomialsAnsSingle", "[", 
   RowBox[{"lv_", ",", "od_List", ",", "rv_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "pt", "}"}], ",", 
    RowBox[{
     RowBox[{"pt", "=", 
      RowBox[{
       RowBox[{"Permutations", "[", "od", "]"}], "//", "DeleteDuplicates"}]}],
      ";", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"lv", ",", "##", ",", "rv"}], "]"}], "&"}], "@@@", "pt"}], 
      ")"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.876804285141453*^9, 3.876804311219627*^9}, {
   3.876804354297196*^9, 3.876804394553791*^9}, {3.876804547147678*^9, 
   3.876804564077526*^9}, 3.8768046310569696`*^9, {3.8768046788966293`*^9, 
   3.876804767317877*^9}, {3.876804900865148*^9, 3.87680509438022*^9}, {
   3.8768051395051527`*^9, 3.876805155807871*^9}, {3.876805253968152*^9, 
   3.876805264267679*^9}, {3.8768053169740458`*^9, 3.876805320484037*^9}, 
   3.876805351239914*^9, {3.8768054423488283`*^9, 3.8768054713281593`*^9}, {
   3.8768055021330214`*^9, 3.876805503038082*^9}, {3.87680557435063*^9, 
   3.8768056288868513`*^9}, {3.876806417065815*^9, 3.876806469431156*^9}, {
   3.876810617157659*^9, 3.876810647969964*^9}, 3.876810746169541*^9, 
   3.877066211011817*^9},
 CellLabel->
  "In[133]:=",ExpressionUUID->"e204db8b-2809-48fb-be8f-268b90ce9dc2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "partitions", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitions", "[", 
   RowBox[{"list_", ",", "l_"}], "]"}], ":=", 
  RowBox[{"Join", "@@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "##"}], "}"}], "&"}], "@@@", 
      RowBox[{"partitions", "[", 
       RowBox[{
        RowBox[{"list", "~", "Complement", "~", "x"}], ",", "l"}], "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Subsets", "[", 
        RowBox[{"list", ",", 
         RowBox[{"{", "l", "}"}], ",", 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "list", "]"}], "-", "1"}], ",", 
           RowBox[{"l", "-", "1"}]}], "]"}]}], "]"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partitions", "[", 
    RowBox[{"list_", ",", "l_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "list", "]"}], "===", "l"}]}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", "list", "}"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.876813314352524*^9, 3.876813328750271*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"da927357-f46e-407a-9b0a-56fdfe11d829"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoAllF", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoAllF", "[", 
   RowBox[{"ptsets_", ",", "vs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mono1", ",", "mono2", ",", "monoAll", ",", "a"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mono1", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"monomialsAnsSingle", "[", 
              RowBox[{
               RowBox[{"vs", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"ptsets", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "jj"}], "]"}], "]"}], ",", 
               RowBox[{"vs", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", ",", "2"}], "]"}], "]"}]}], "]"}], "//", 
             "Total"}], ",", 
            RowBox[{"{", 
             RowBox[{"jj", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"ptsets", "[", 
                RowBox[{"[", "ii", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mono2", "=", 
          RowBox[{"(", 
           RowBox[{"Times", "@@", "mono1"}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"monoAll", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"List", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "+", "mono2"}], "//", "Expand"}], ")"}]}], ",", 
            "a"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "ptsets"}]}], "}"}]}], "]"}], "//", 
      "Flatten"}], "//", "DeleteDuplicates"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.876811369960775*^9, 3.8768113727341633`*^9}, {
   3.876811485009445*^9, 3.876811595092298*^9}, {3.876811639699731*^9, 
   3.876811640893647*^9}, 3.8768116783304043`*^9, {3.876811716061986*^9, 
   3.876811732470446*^9}, {3.876811790156522*^9, 3.876811796540135*^9}, {
   3.8768118801902447`*^9, 3.876811892921207*^9}, {3.876811927282494*^9, 
   3.876812045955064*^9}, {3.876812090166971*^9, 3.876812166246018*^9}, {
   3.876812217543675*^9, 3.8768122751008883`*^9}, {3.876812307151626*^9, 
   3.876812392859235*^9}, 3.876812451314582*^9, 3.8773367732900352`*^9, {
   3.877344524700871*^9, 3.877344554764751*^9}, {3.8773446377947187`*^9, 
   3.877344642934064*^9}, {3.877344709517954*^9, 3.8773447168750067`*^9}, {
   3.877344826511199*^9, 3.877344918321042*^9}, {3.877351477664247*^9, 
   3.8773514780370626`*^9}, {3.877351529018159*^9, 3.877351561254724*^9}, {
   3.877353282330694*^9, 3.877353342917494*^9}, {3.877353392697257*^9, 
   3.8773534009593678`*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"862aa9f1-067d-4c15-bc1c-c2635cfe2b7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dotRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "a_"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{"0", "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"S", "[", "i", "]"}], ",", "b"}], "}"}], "==", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"S", "[", "i", "]"}], ",", "b"}], "}"}], "]"}]}], "&&", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "a", "}"}], "]"}], "\[Equal]", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "b", "}"}], "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{"0", "/;", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "b"}], "}"}], "==", 
        RowBox[{"Reverse", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "}"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "a_"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "b_"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"S", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[NotEqual]", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b_"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[NotEqual]", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "a_", "]"}], ",", 
        RowBox[{"F", "[", "a_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"b__", ",", 
        RowBox[{"F", "[", "a_", "]"}], ",", 
        RowBox[{"p", "[", "a_", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"b__", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "a"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"v", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"v", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "a__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"p", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     " ", ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "i_", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", "a__", "]"}], "\[RuleDelayed]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}], "*", 
        RowBox[{"dot", "@@", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}]}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "a", "}"}], "//", "Reverse"}], ",", 
           RowBox[{"{", "a", "}"}]}], "}"}], "]"}], "&&", 
        RowBox[{
         RowBox[{"{", "a", "}"}], "=!=", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}]}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.87735352765903*^9, 3.877353575291686*^9}, {
   3.877506147842967*^9, 3.877506190551264*^9}, 3.878020458873892*^9, 
   3.878968334460478*^9, {3.8792364567407217`*^9, 3.879236472221311*^9}, 
   3.8792374471519213`*^9, 3.879411830989043*^9, {3.879642906690938*^9, 
   3.8796429172788982`*^9}, {3.879645132103675*^9, 3.879645132106102*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"a19e5a8e-8ac2-43c2-83e6-b9313c1e10b8"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "evalsc", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evalsc", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"cosh", "->", "Cosh"}], ",", 
     RowBox[{"sinh", "->", "Sinh"}], ",", 
     RowBox[{
      RowBox[{"sinch", "[", "f_", "]"}], ":>", 
      FractionBox[
       RowBox[{"Sinh", "[", "f", "]"}], "f"]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8792207611038017`*^9, 3.87922079447575*^9}, {
  3.879221251565415*^9, 3.879221269755252*^9}, {3.879501721889482*^9, 
  3.8795017552935877`*^9}, {3.8795446031770773`*^9, 3.879544608465846*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"b6e0f9c9-b6e2-449c-8c19-c1e043de40f5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Gsc", ",", "gsc"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gsc", "[", 
   RowBox[{"x1_", ",", "xs__"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rhoa", ",", "rhob", ",", "rholist", ",", "res"}], "}"}], ",", 
    RowBox[{
     RowBox[{"rholist", "=", 
      RowBox[{"KSetPartitionsEmpty", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "xs"}], "}"}], ",", "2"}], "]"}]}], ";", 
     RowBox[{"res", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rholist", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "2"}], "]"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"rhob", "=", "1"}], ",", 
           RowBox[{"rhob", "=", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "*", 
                  RowBox[{"cosh", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
               RowBox[{"rholist", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "2"}], "]"}], "]"}]}], ")"}]}]}]}], "]"}],
          ";", 
         RowBox[{
          RowBox[{"sinch", "[", 
           RowBox[{"Total", "[", 
            RowBox[{"rholist", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "*", 
          "rhob"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "rholist"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     FractionBox["res", 
      RowBox[{"Times", "[", "xs", "]"}]]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gsc", "[", 
   RowBox[{"x1_p", ",", "xs___"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rhoa", ",", "rhob", ",", "rholist", ",", "res"}], "}"}], ",", 
    RowBox[{
     RowBox[{"rholist", "=", 
      RowBox[{"KSetPartitionsEmpty", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "xs"}], "}"}], ",", "2"}], "]"}]}], ";", 
     RowBox[{"res", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rholist", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "2"}], "]"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"rhob", "=", "1"}], ",", 
           RowBox[{"rhob", "=", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "*", 
                  RowBox[{"cosh", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
               RowBox[{"rholist", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "2"}], "]"}], "]"}]}], ")"}]}]}]}], "]"}],
          ";", 
         RowBox[{
          RowBox[{"sinch", "[", 
           RowBox[{"Total", "[", 
            RowBox[{"rholist", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "*", 
          "rhob"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "rholist"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       FractionBox["res", 
        RowBox[{"Times", "@@", 
         RowBox[{"(", 
          RowBox[{"{", "xs", "}"}], ")"}]}]], "/.", 
       RowBox[{
        RowBox[{"p", "[", "i__", "]"}], ":>", 
        RowBox[{"dot", "[", 
         RowBox[{"a", ",", 
          RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"p", "[", "f__", "]"}], ":>", 
       RowBox[{"Total", "[", 
        RowBox[{"p", "/@", 
         RowBox[{"{", "f", "}"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.879219218140274*^9, 3.879219264939589*^9}, {
   3.879219299355112*^9, 3.879219311698654*^9}, {3.8792193657692842`*^9, 
   3.879219368659751*^9}, {3.879219553770399*^9, 3.879219634556808*^9}, {
   3.8792196730309353`*^9, 3.879219689570814*^9}, {3.8792197387144012`*^9, 
   3.879219835571166*^9}, {3.8792199242952213`*^9, 3.879220015609503*^9}, {
   3.8792200953290052`*^9, 3.879220141518895*^9}, {3.879220441752841*^9, 
   3.879220512676399*^9}, {3.879220602930214*^9, 3.879220634858861*^9}, {
   3.879221324750793*^9, 3.879221360755177*^9}, {3.879232047140245*^9, 
   3.879232163163957*^9}, {3.8792384910478573`*^9, 3.87923854381818*^9}, {
   3.879238579572566*^9, 3.8792385881326838`*^9}, 3.879501692409511*^9, {
   3.879501793232894*^9, 3.8795018057264967`*^9}, {3.879502335648642*^9, 
   3.879502337172986*^9}, {3.8795034317663603`*^9, 3.879503461847233*^9}, 
   3.8795452349277678`*^9, 3.879642929907148*^9, 3.879645132108659*^9},
 CellLabel->
  "In[143]:=",ExpressionUUID->"b829f322-2824-4e19-a081-6df18bc367f5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "wtoVS", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wtoVS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"w", "[", "i__", "]"}], ",", "x_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Cosh", "[", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "a"}], "]"}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", "x"}], "]"}]}], "-", 
       RowBox[{"I", " ", 
        FractionBox[
         RowBox[{"Sinh", "[", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "i", "]"}], ",", "a"}], "]"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "a"}], "]"}]], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"S", "[", "0", "]"}], ",", "x"}], "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"x_", ",", 
        RowBox[{"w", "[", "i__", "]"}]}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Cosh", "[", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "a"}], "]"}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", "x"}], "]"}]}], "-", 
       RowBox[{"I", " ", 
        FractionBox[
         RowBox[{"Sinh", "[", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "i", "]"}], ",", "a"}], "]"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "a"}], "]"}]], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"S", "[", "0", "]"}], ",", "x"}], "]"}]}]}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8796429331538563`*^9, 3.879642946377585*^9}, {
  3.8796451321109943`*^9, 3.879645132116454*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"e7497423-7770-40aa-bb74-b4be0294df1f"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryVectorPair", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryVectorPair", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", "f", "}"}], "/.", 
        RowBox[{
         RowBox[{"a_", " ", "b_"}], ":>", 
         RowBox[{"b", "/;", 
          RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "/.", 
       RowBox[{"Times", "->", "List"}]}], "/.", 
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{"g_", ",", "n_"}], "]"}], ":>", 
       RowBox[{"Table", "[", 
        RowBox[{"g", ",", "n"}], "]"}]}]}], "//", "Flatten"}], ")"}], "/.", 
   RowBox[{"dot", "->", "List"}]}]}]}], "Input",
 CellChangeTimes->{{3.879292514390602*^9, 3.8792925899136953`*^9}, {
  3.879292621607851*^9, 3.879292626222397*^9}, {3.879292679256337*^9, 
  3.879292741125108*^9}, {3.879292853793107*^9, 3.8792928551630287`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"137f7a93-d896-415d-bb1e-f3ce16b6a8ea"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoFSOdd", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoFSOdd", "[", 
   RowBox[{"grad_", ",", "glueNumber_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "bvp", ",", "bvpall", ",", "ptsets", ",", "allmonos", ",", "vponshell"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"vponshell", "=", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"glueNumber", "+", "1"}], ",", "1"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"grad", "==", "1"}], ",", 
       RowBox[{
        RowBox[{"ptsets", "=", 
         RowBox[{"KSetPartitionsEmpty", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"F", "[", "ii", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"ii", ",", "glueNumber"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"S", "[", "0", "]"}], "}"}]}], "]"}], ",", "1"}], 
          "]"}]}], ";", 
        RowBox[{"allmonos", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"monoAllF", "[", 
                    RowBox[{"ptsets", ",", "#"}], "]"}], "&"}], "/@", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"lI", "[", "0", "]"}], ",", 
                    RowBox[{"lI", "[", "0", "]"}]}], "}"}], "}"}], "}"}]}], 
                  ")"}], "//", "Flatten"}], ")"}], "//.", "dotRules"}], "/.", 
              
              RowBox[{
               RowBox[{"a_", " ", "b_"}], "\[RuleDelayed]", " ", 
               RowBox[{"b", "/;", 
                RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], "//", "Flatten"}], 
            "//", "DeleteDuplicates"}], ",", "0"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"grad", ">=", "2"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptsets", "=", 
         RowBox[{"KSetPartitionsEmpty", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"F", "[", "ii", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"ii", ",", "glueNumber"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"S", "[", "0", "]"}], "}"}]}], "]"}], ",", 
           RowBox[{"grad", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"bvp", "=", 
         RowBox[{"BoundaryVectorPair", "/@", 
          RowBox[{"MonomialList", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"Total", "[", 
                RowBox[{"p", "/@", 
                 RowBox[{"Range", "[", "glueNumber", "]"}]}], "]"}], ",", 
               "a"}], "]"}], 
             RowBox[{"grad", "-", "1"}]], "//", "Expand"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bvpall", "=", 
         RowBox[{
          RowBox[{"Join", "@@", 
           RowBox[{"(", 
            RowBox[{"Permutations", "/@", "bvp"}], ")"}]}], "//", "Union"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"allmonos", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"monoAllF", "[", 
                    RowBox[{"ptsets", ",", "#"}], "]"}], "&"}], "/@", 
                   "bvpall"}], ")"}], "//", "Flatten"}], ")"}], "//.", 
               "dotRules"}], 
              RowBox[{"(*", 
               RowBox[{"/.", "vponshell"}], "*)"}], "/.", 
              RowBox[{
               RowBox[{"a_", " ", "b_"}], "\[RuleDelayed]", " ", 
               RowBox[{"b", "/;", 
                RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], "//", "Flatten"}], 
            "//", "DeleteDuplicates"}], ",", "0"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "allmonos"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8793054377520638`*^9, 3.879305534073194*^9}, {
   3.879305578534507*^9, 3.8793055802516117`*^9}, {3.879305677449963*^9, 
   3.879305819686283*^9}, {3.879305894700564*^9, 3.8793059195360203`*^9}, {
   3.879306605215102*^9, 3.879306621289269*^9}, {3.8795004168700247`*^9, 
   3.8795004529550877`*^9}, {3.8795027523368998`*^9, 
   3.8795027686155977`*^9}, {3.879502818834166*^9, 3.879502841566842*^9}, {
   3.8795028764251213`*^9, 3.8795028816950903`*^9}, 3.879642946381255*^9, 
   3.879645132119944*^9},
 CellLabel->
  "In[150]:=",ExpressionUUID->"b708a7a6-63f3-4625-b102-0cebf08b0332"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoFSEven", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoFSEven", "[", 
   RowBox[{"grad_", ",", "glueNumber_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "bvp", ",", "bvpall", ",", "ptsets", ",", "x", ",", "allmonos", ",", 
      "vponshell"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vponshell", "=", 
      RowBox[{
       RowBox[{"vonshell", "[", 
        RowBox[{
         RowBox[{"glueNumber", "+", "1"}], ",", "1"}], "]"}], "/.", 
       RowBox[{"v", "->", 
        RowBox[{"v", "[", "1", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"grad", ">=", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptsets", "=", 
         RowBox[{"KSetPartitionsEmpty", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"F", "[", "ii", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "glueNumber"}], "}"}]}], "]"}], ",", 
           "grad"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bvp", "=", 
         RowBox[{"BoundaryVectorPair", "/@", 
          RowBox[{"MonomialList", "[", 
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"dot", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"p", "/@", 
                    RowBox[{"Range", "[", "glueNumber", "]"}]}], "]"}], "+", 
                    RowBox[{"v", "[", "1", "]"}]}], ",", "a"}], "]"}], 
                  "grad"], "//", "Expand"}], ")"}], "/.", 
               RowBox[{
                RowBox[{"v", "[", "1", "]"}], "->", 
                RowBox[{"x", " ", 
                 RowBox[{"v", "[", "1", "]"}]}]}]}], "/.", 
              RowBox[{
               RowBox[{"Power", "[", 
                RowBox[{"x", ",", "n_"}], "]"}], ":>", "0"}]}], ",", "x"}], 
            "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bvpall", "=", 
         RowBox[{
          RowBox[{"Join", "@@", 
           RowBox[{"(", 
            RowBox[{"Permutations", "/@", "bvp"}], ")"}]}], "//", "Union"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"allmonos", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"monoAllF", "[", 
                    RowBox[{"ptsets", ",", "#"}], "]"}], "&"}], "/@", 
                    "bvpall"}], ")"}], "//", "Flatten"}], ")"}], "//.", 
                "dotRules"}], "/.", "vponshell"}], "/.", 
              RowBox[{
               RowBox[{"a_", " ", "b_"}], "\[RuleDelayed]", " ", 
               RowBox[{"b", "/;", 
                RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], "//", "Flatten"}], 
            "//", "DeleteDuplicates"}], ",", "0"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "allmonos"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.879500334875784*^9, 3.8795003669263973`*^9}, 
   3.879500494983358*^9, {3.8795006775381203`*^9, 3.8795007375894747`*^9}, {
   3.879500795955484*^9, 3.8795008451797037`*^9}, {3.8795008795849543`*^9, 
   3.879500912392889*^9}, {3.879501208023896*^9, 3.879501274499544*^9}, {
   3.87950143431137*^9, 3.879501460621251*^9}, {3.8795014910348053`*^9, 
   3.879501500282771*^9}, {3.879547096713623*^9, 3.879547121571583*^9}, 
   3.879642946384837*^9, 3.879645132123209*^9},
 CellLabel->
  "In[152]:=",ExpressionUUID->"e6380e8f-8cd3-484f-becf-14b738e64127"]
}, Closed]],

Cell[CellGroupData[{

Cell["counting monomial topology", "Subsection",
 CellChangeTimes->{{3.879634655980435*^9, 
  3.879634663996876*^9}},ExpressionUUID->"d7d4b682-367d-4623-bda5-\
17f1363186ad"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"signNormalOrderJ", ",", "NormalOrderJ"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"signNormalOrderJ", "=", 
   RowBox[{
    RowBox[{"J", "[", "f___", "]"}], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"Signature", "[", 
      RowBox[{"{", "f", "}"}], "]"}], " ", 
     RowBox[{"J", "[", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{"{", "f", "}"}], "]"}], "/.", "\[VeryThinSpace]", 
       RowBox[{
        RowBox[{"{", "g___", "}"}], "\[RuleDelayed]", "g"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NormalOrderJ", "=", 
   RowBox[{
    RowBox[{"J", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"J", "[", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{"{", "f", "}"}], "]"}], "/.", "\[VeryThinSpace]", 
      RowBox[{
       RowBox[{"{", "g___", "}"}], "\[RuleDelayed]", "g"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.823397922476475*^9, 3.823397924532007*^9}, {
  3.826772346182486*^9, 3.826772355582357*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"9843905e-2c94-48d1-8581-954938700b5d"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "MolienSeries", ",", "MolienSeriesT", ",", "PermutationMatrix", ",", 
   "CycleForm", ",", "ListToParens"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PermutationMatrix", "[", "p_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{"Length", "[", "p", "]"}], "]"}], "[", 
    RowBox[{"[", "p", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MolienSeries", "[", 
   RowBox[{"group_", ",", "repSpace_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"gList", "=", 
       RowBox[{"group", "//", "GroupElements"}]}], ",", 
      RowBox[{"dim", "=", 
       RowBox[{"Length", "[", "repSpace", "]"}]}], ",", "repgList", ",", 
      "repMatrix"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", "dim", "]"}], ";"}], "*)"}], 
    RowBox[{
     RowBox[{"repgList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"repSpace", "/.", 
           RowBox[{"replace", "[", 
            RowBox[{
             RowBox[{"p", "/@", 
              RowBox[{"PermutationList", "[", 
               RowBox[{
                RowBox[{"gList", "[", 
                 RowBox[{"[", "gg", "]"}], "]"}], ",", 
                RowBox[{"n", "-", "1"}]}], "]"}]}], ",", "n"}], "]"}]}], "/.", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"f1_", ",", "f2_"}], "]"}], "\[RuleDelayed]", " ", 
           RowBox[{"Position", "[", 
            RowBox[{"repSpace", ",", 
             RowBox[{"dot", "[", 
              RowBox[{"f1", ",", "f2"}], "]"}]}], "]"}]}]}], "//", 
         "Flatten"}], ",", 
        RowBox[{"{", 
         RowBox[{"gg", ",", 
          RowBox[{"Length", "@", "gList"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "repgList", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"repMatrix", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PermutationMatrix", "[", 
         RowBox[{"repgList", "[", 
          RowBox[{"[", "gg", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"gg", ",", 
          RowBox[{"Length", "@", "gList"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"Length", "@", "gList"}]], "*", 
      RowBox[{"Sum", "[", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"Det", "[", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "dim", "]"}], "-", 
           RowBox[{"z", " ", 
            RowBox[{"repMatrix", "[", 
             RowBox[{"[", "gg", "]"}], "]"}]}]}], " ", "]"}]], ",", 
        RowBox[{"{", 
         RowBox[{"gg", ",", 
          RowBox[{"Length", "@", "gList"}]}], "}"}]}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MolienSeriesT", "[", 
   RowBox[{"group_", ",", "repSpace_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"gList", "=", 
       RowBox[{"group", "//", "GroupElements"}]}], ",", 
      RowBox[{"dim", "=", 
       RowBox[{"Length", "[", "repSpace", "]"}]}], ",", "repgList", ",", 
      "repMatrix"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", "dim", "]"}], ";"}], "*)"}], 
    RowBox[{
     RowBox[{"repgList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"T", "@@@", "repSpace"}], "/.", 
              RowBox[{"replace", "[", 
               RowBox[{
                RowBox[{"p", "/@", 
                 RowBox[{"PermutationList", "[", 
                  RowBox[{
                   RowBox[{"gList", "[", 
                    RowBox[{"[", "gg", "]"}], "]"}], ",", 
                   RowBox[{"n", "-", "1"}]}], "]"}]}], ",", "n"}], "]"}]}], 
             ")"}], "/.", 
            RowBox[{
             RowBox[{"dot", "[", "hhh__", "]"}], "\[RuleDelayed]", " ", 
             RowBox[{"Sort", "[", 
              RowBox[{"dot", "[", "hhh", "]"}], "]"}]}]}], "/.", 
           "NormalOrderJ"}], "/.", 
          RowBox[{
           RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"repSpace", "/.", 
               RowBox[{
                RowBox[{"dot", "[", "hhh__", "]"}], "\[RuleDelayed]", " ", 
                RowBox[{"Sort", "[", 
                 RowBox[{"dot", "[", "hhh", "]"}], "]"}]}]}], "/.", 
              "NormalOrderJ"}], ",", 
             RowBox[{"Times", "[", "f", "]"}]}], "]"}]}]}], "//", "Flatten"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"gg", ",", 
          RowBox[{"Length", "@", "gList"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "repgList", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"repMatrix", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PermutationMatrix", "[", 
         RowBox[{"repgList", "[", 
          RowBox[{"[", "gg", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"gg", ",", 
          RowBox[{"Length", "@", "gList"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"Length", "@", "gList"}]], "*", 
      RowBox[{"Sum", "[", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"Det", "[", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "dim", "]"}], "-", 
           RowBox[{"z", " ", 
            RowBox[{"repMatrix", "[", 
             RowBox[{"[", "gg", "]"}], "]"}]}]}], " ", "]"}]], ",", 
        RowBox[{"{", 
         RowBox[{"gg", ",", 
          RowBox[{"Length", "@", "gList"}]}], "}"}]}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CycleForm", "[", "kk_List", "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"gg", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"#", ",", 
                RowBox[{"First", "[", "#", "]"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", "1"}]}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"First", "[", 
         RowBox[{"Sort", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"RotateRight", "[", 
             RowBox[{"gg", ",", "n"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "0", ",", 
              RowBox[{
               RowBox[{"Length", "[", "gg", "]"}], "-", "1"}]}], "}"}]}], 
           "]"}], "]"}], "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"NestList", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"kk", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "kk", ",", 
        RowBox[{
         RowBox[{"Length", "[", "kk", "]"}], "+", "2"}]}], "]"}], "]"}]}], 
    "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListToParens", "[", "a_List", "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<(\>\"", ",", 
    RowBox[{"ToString", "[", 
     RowBox[{"FromDigits", "[", "a", "]"}], "]"}], ",", "\"\<)\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "AutoMorphismGroupGen", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AutoMorphismGroupGen", "[", 
   RowBox[{"f_", ",", "gSn_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"gSn", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"GroupAction", "[", 
           RowBox[{"f", ",", 
            RowBox[{"gSn", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "n"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "gSn"}]}], "}"}]}], "]"}], "/.", 
        "NormalOrderJ"}], ",", "f"}], "]"}], "//", "Flatten"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "antiPermute", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"antiPermute", "[", 
   RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"antisym", "[", 
      RowBox[{"T", "@@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"g___", ",", "n"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"(", 
       RowBox[{"f", "/.", " ", 
        RowBox[{"replace", "[", 
         RowBox[{
          RowBox[{"p", "/@", 
           RowBox[{"{", "g", "}"}]}], ",", "n"}], "]"}]}], ")"}]}]}], ")"}], "/.",
    "signNormalOrder"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"antiPermute", "[", 
   RowBox[{"f_", ",", "nb_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"antisym", "[", 
      RowBox[{
       RowBox[{"T", "@@", 
        RowBox[{"Range", "[", 
         RowBox[{"nb", ",", 
          RowBox[{"n", "-", "1"}]}], "]"}]}], ",", "nb"}], "]"}], "/.", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"g___", ",", "n"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"(", 
       RowBox[{"f", "/.", " ", 
        RowBox[{"replace", "[", 
         RowBox[{
          RowBox[{"p", "/@", 
           RowBox[{"{", "g", "}"}]}], ",", "n"}], "]"}]}], ")"}]}]}], ")"}], "/.",
    "signNormalOrder"}]}]}], "Input",
 CellChangeTimes->{{3.7749358949518747`*^9, 3.774935947573471*^9}, {
   3.7749458924501667`*^9, 3.774945893235462*^9}, {3.774946854387269*^9, 
   3.7749468549041843`*^9}, {3.774947254724374*^9, 3.7749472552865877`*^9}, {
   3.775800763665078*^9, 3.7758008286924753`*^9}, {3.775800982016409*^9, 
   3.7758009821774282`*^9}, {3.775802651622407*^9, 3.775802653152355*^9}, {
   3.808377448150489*^9, 3.808377454641568*^9}, {3.808377558095632*^9, 
   3.808377565761951*^9}, {3.808382229731889*^9, 3.8083822955590477`*^9}, 
   3.80838430504357*^9, {3.808544942328141*^9, 3.808544945666813*^9}, {
   3.8210033005023947`*^9, 3.821003335042551*^9}, 3.821003890356265*^9, {
   3.821004071231441*^9, 3.8210040915483837`*^9}, {3.821004722391021*^9, 
   3.821004731139571*^9}, 3.8210047779943323`*^9, {3.823397901447547*^9, 
   3.8233979313292027`*^9}, {3.8233980376998453`*^9, 3.823398044331002*^9}, {
   3.8233984601994877`*^9, 3.823398469458852*^9}, {3.8234070749756203`*^9, 
   3.823407125880678*^9}, {3.823409104469372*^9, 3.8234091428324738`*^9}, {
   3.823409212702952*^9, 3.823409214038415*^9}, {3.8234120830178547`*^9, 
   3.8234120884706917`*^9}, 3.8267722914766817`*^9, {3.8267723350909767`*^9, 
   3.826772489554022*^9}, 3.8267734777878723`*^9, {3.8267738391015377`*^9, 
   3.826773844943013*^9}, {3.8802345435138903`*^9, 3.8802345456295137`*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"fff81519-03fe-4998-a657-8f731fa3af53"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GroupAction", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GroupAction", "[", 
   RowBox[{"f_", ",", "g_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{"replace", "[", 
    RowBox[{"(", 
     RowBox[{"PermutationList", "[", 
      RowBox[{"g", ",", "n"}], "]"}], ")"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.880234530873522*^9, 3.880234571292714*^9}, {
  3.880235002705789*^9, 3.880235003082184*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"b9731d42-99cc-42e5-8ef3-f8e43b62d601"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "OpAction", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OpAction", "[", 
   RowBox[{"f_", ",", "op_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"op", "/.", 
   RowBox[{
    RowBox[{"Cycles", "[", "gg_", "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"GroupAction", "[", 
     RowBox[{"f", ",", 
      RowBox[{"Cycles", "[", "gg", "]"}], ",", "n"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.880234067252119*^9, 3.8802340674507093`*^9}, {
  3.8802341420672092`*^9, 3.880234143697246*^9}, {3.8802341909572077`*^9, 
  3.880234191465658*^9}, {3.8802344328075523`*^9, 3.880234438545515*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"94bcb61a-2fdb-4f39-adf8-b6f4e3d676f1"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GroupProduct", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GroupProduct", "[", 
   RowBox[{"a_Plus", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GroupProduct", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"GroupProduct", "[", 
         RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", "a"}], ")"}]}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GroupProduct", "[", 
   RowBox[{"a_", ",", "b_Plus"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GroupProduct", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"GroupProduct", "[", 
         RowBox[{"a", ",", "#"}], "]"}], "&"}], "/@", "b"}], ")"}]}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GroupProduct", "[", 
   RowBox[{"c___", ",", "a_Plus", ",", "b___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"GroupProduct", "[", 
        RowBox[{"c", ",", "#", ",", "b"}], "]"}], "&"}], "/@", "a"}], ")"}]}],
    "//", "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GroupProduct", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "a__"}], "]"}], ",", "b___"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"GroupProduct", "[", 
    RowBox[{
     RowBox[{"Times", "[", "a", "]"}], ",", "b"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"GroupProduct", "[", 
   RowBox[{"b___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "a__"}], "]"}], ",", "c___"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"GroupProduct", "[", 
    RowBox[{"b", ",", 
     RowBox[{"Times", "[", "a", "]"}], ",", "c"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GroupProduct", "[", 
   RowBox[{"a___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "b__"}], "]"}]}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"GroupProduct", "[", 
    RowBox[{"a", ",", 
     RowBox[{"Times", "[", "b", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GroupProduct", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"s_", "/;", 
       RowBox[{"NumberQ", "[", "s", "]"}]}], ",", "a_Cycles"}], "]"}], ",", 
    "b___"}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"GroupProduct", "[", 
    RowBox[{
     RowBox[{"Times", "[", "a", "]"}], ",", "b"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"GroupProduct", "[", 
   RowBox[{"b___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"s_", "/;", 
       RowBox[{"NumberQ", "[", "s", "]"}]}], ",", "a_Cycles"}], "]"}], ",", 
    "c___"}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"GroupProduct", "[", 
    RowBox[{"b", ",", 
     RowBox[{"Times", "[", "a", "]"}], ",", "c"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GroupProduct", "[", 
   RowBox[{"a___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"s_", "/;", 
       RowBox[{"NumberQ", "[", "s", "]"}]}], ",", "b_Cycles"}], "]"}]}], 
   "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"GroupProduct", "[", 
    RowBox[{"a", ",", 
     RowBox[{"Times", "[", "b", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GroupProduct", "[", "f___", "]"}], ":=", 
  RowBox[{"PermutationProduct", "@@", 
   RowBox[{"Reverse", "[", 
    RowBox[{"{", "f", "}"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.808563802566525*^9, 3.808563815586982*^9}, {
  3.808563999232285*^9, 3.808564042129608*^9}, {3.808564405246821*^9, 
  3.808564566470767*^9}, {3.808564608283668*^9, 3.808564628889304*^9}, {
  3.808564714158288*^9, 3.808564715218976*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"fc9203ff-b546-4131-a912-64f29b1d18fb"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"ROperator", ",", "OOperator"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ROperator", "[", "list___", "]"}], ":=", 
  RowBox[{"GroupProduct", "@@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Cycles", "[", 
       RowBox[{"{", "}"}], "]"}], "-", 
      RowBox[{"Cycles", "[", 
       RowBox[{"{", 
        RowBox[{"Reverse", "[", 
         RowBox[{"list", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "ii"}], "]"}], "]"}], "]"}], "}"}], "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "2", ",", 
       RowBox[{"Length", "@", "list"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OOperator", "[", "list___", "]"}], ":=", 
  RowBox[{"GroupProduct", "@@", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cycles", "[", 
         RowBox[{"{", "}"}], "]"}], "-", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{"Reverse", "[", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "ii"}], "]"}], "]"}], "]"}], "}"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "2", ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"Length", "@", "list"}]}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"-", 
       RowBox[{"Cycles", "[", 
        RowBox[{"{", 
         RowBox[{"Reverse", "[", "list", "]"}], "}"}], "]"}]}], "}"}]}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.808563852915638*^9, 3.808563885289365*^9}, {
   3.8085648284594793`*^9, 3.808564990818927*^9}, {3.8085650226103973`*^9, 
   3.808565053107888*^9}, {3.808565144836473*^9, 3.808565226553296*^9}, 
   3.808565259481357*^9},
 CellLabel->
  "In[183]:=",ExpressionUUID->"fb871dec-8df0-4419-b039-94062df49d6a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "scExpand", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scExpand", "[", "i_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Cosh", "[", "x_", "]"}], ":>", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{"Cosh", "[", 
           RowBox[{"T", "[", "x", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"T", "[", "x", "]"}], ",", "0", ",", "i"}], "}"}]}], 
         "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"T", "[", "f_", "]"}], ":>", "f"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"Sinh", "[", "x_", "]"}], ":>", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{"Sinh", "[", 
           RowBox[{"T", "[", "x", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"T", "[", "x", "]"}], ",", "0", ",", "i"}], "}"}]}], 
         "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"T", "[", "f_", "]"}], ":>", "f"}]}], ")"}]}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.885265472232739*^9, 3.885265557714657*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"700aa801-4511-4d25-8bfc-87c6523334ba"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["four-pointCK two-scalar", "Section",
 CellChangeTimes->{{3.8564069369813757`*^9, 3.8564069411881237`*^9}, {
  3.856528505387108*^9, 3.856528508392273*^9}, {3.864366397575654*^9, 
  3.8643663998630047`*^9}, {3.864474113286031*^9, 3.864474114889228*^9}, {
  3.8644743167650013`*^9, 3.864474317970113*^9}, {3.864521747019771*^9, 
  3.864521765508876*^9}, {3.8671075959622383`*^9, 3.867107597914331*^9}, {
  3.8690095454796762`*^9, 3.869009579711589*^9}, {3.869013163073915*^9, 
  3.869013164565288*^9}, {3.86901640347239*^9, 3.8690164046186666`*^9}, {
  3.903909774833173*^9, 
  3.9039097764348993`*^9}},ExpressionUUID->"f3c55150-e668-44e7-898f-\
cd9d17d0534a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bpeff2", "=", 
  RowBox[{"GBinaryProduct", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "1"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.856406944192731*^9, 3.856407154239691*^9}, {
   3.8564072455711*^9, 3.856407245645687*^9}, {3.856413039297926*^9, 
   3.856413051829617*^9}, {3.8564131236559477`*^9, 3.856413146983698*^9}, {
   3.856413589269986*^9, 3.856413589394957*^9}, {3.856413779266163*^9, 
   3.8564137987202*^9}, {3.856413968953669*^9, 3.856413969203106*^9}, {
   3.856414567583549*^9, 3.8564145676976624`*^9}, {3.85641460049174*^9, 
   3.8564146007287083`*^9}, {3.8564148799503937`*^9, 3.856414880161378*^9}, {
   3.856416341053227*^9, 3.8564163414112988`*^9}, {3.856416495678156*^9, 
   3.8564164958083982`*^9}, {3.856527506825643*^9, 3.856527507105521*^9}, {
   3.856527588144096*^9, 3.856527588651093*^9}, {3.85652825499409*^9, 
   3.856528255112001*^9}, {3.863908747569974*^9, 3.863908747957382*^9}, {
   3.8639088120452642`*^9, 3.863908812560042*^9}, {3.864000932947801*^9, 
   3.864000933289227*^9}, {3.8640021469804697`*^9, 3.864002147091778*^9}, {
   3.864195379596553*^9, 3.864195379912004*^9}, {3.864362920662867*^9, 
   3.864362921454373*^9}, {3.864364483001431*^9, 3.864364483252904*^9}, {
   3.864429883315426*^9, 3.864429886702735*^9}, {3.8644299369166393`*^9, 
   3.864429937326201*^9}, {3.864430727680728*^9, 3.8644307298724613`*^9}, {
   3.864474322053412*^9, 3.8644743222798147`*^9}, {3.864521517831593*^9, 
   3.8645215182707872`*^9}, {3.864521810710506*^9, 3.864521811100687*^9}, {
   3.867107628808774*^9, 3.867107654474802*^9}, {3.867107731997066*^9, 
   3.867107769383843*^9}, {3.869009555049245*^9, 3.869009556072699*^9}, {
   3.8690166317813*^9, 3.869016631938167*^9}, {3.903904713791759*^9, 
   3.903904772489691*^9}, 3.903909783641466*^9},
 CellLabel->
  "In[277]:=",ExpressionUUID->"604299c3-616b-47e8-bdaf-2e37fad2362c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "3"}], "]"}], ",", "2"}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8671077331244783`*^9, 3.867107770016876*^9}, 
   3.869008935636294*^9, 3.8690095244219227`*^9, 3.869009556476042*^9, 
   3.8690131908260717`*^9, 3.869016633048568*^9, 3.8796402426847277`*^9, 
   3.879640528439271*^9, 3.900144144489194*^9, 3.903904564818653*^9, 
   3.9039047731352177`*^9, 3.903909784173613*^9},
 CellLabel->
  "Out[278]=",ExpressionUUID->"8bfc06c3-7dfc-40cb-b3dd-3a1194f7db06"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bpeff2", "=", 
  RowBox[{"bpeff2", "//", 
   RowBox[{"Cases", "[", 
    RowBox[{"X", "[", 
     RowBox[{"f_", ",", "3"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.903904800256308*^9, 3.903904826655262*^9}, {
   3.903905356537299*^9, 3.903905363734603*^9}, 3.9039097886853113`*^9},
 CellLabel->
  "In[279]:=",ExpressionUUID->"148e3d5e-839f-42c4-b0e6-b2d694807745"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"X", "[", 
   RowBox[{
    RowBox[{"X", "[", 
     RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}], "}"}]], "Output",
 CellChangeTimes->{3.903905364283153*^9, 3.903909789680279*^9},
 CellLabel->
  "Out[279]=",ExpressionUUID->"30619f31-4572-4bd6-b6b5-bc6bfc1bb3db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "[", 
   RowBox[{
    RowBox[{"X", "[", 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}], ",", "4"}], "]"}], "//",
   "X2Prop"}]], "Input",
 CellChangeTimes->{{3.903907870252439*^9, 3.903907874851541*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"171b5c70-3e5b-4c0f-ac2b-e87f2675e90f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"1", ",", "2"}], "]"}], ",", 
    RowBox[{"p", "[", 
     RowBox[{"1", ",", "2"}], "]"}]}], "]"}], " ", 
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"1", ",", "2", ",", "3"}], "]"}], ",", 
    RowBox[{"p", "[", 
     RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.903907875282118*^9},
 CellLabel->
  "Out[189]=",ExpressionUUID->"ec615f86-9e96-4bf9-a8f2-722646cf3485"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Generate", " ", "pre"}], "-", "numerator"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"preNumerator", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[FivePointedStar]", "[", 
         RowBox[{
          RowBox[{"\[ScriptCapitalK]", "[", 
           RowBox[{"1", ",", "1"}], "]"}], ",", 
          RowBox[{"\[ScriptCapitalK]", "[", 
           RowBox[{"2", ",", "1"}], "]"}], ",", 
          RowBox[{"\[ScriptCapitalK]", "[", 
           RowBox[{"3", ",", "0"}], "]"}]}], "]"}], "/.", 
        RowBox[{"ET", ":>", "ET2F2s"}]}], "/.", 
       RowBox[{
        RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
        RowBox[{"tr", "[", 
         RowBox[{"f", ",", 
          RowBox[{"\[DoubleStruckT]", "^", 
           RowBox[{"\[DoubleStruckA]", "[", "n", "]"}]}]}], "]"}]}]}], "/.", 
      "rmzero"}], "/.", 
     RowBox[{
      RowBox[{"tr", "[", "__", "]"}], ":>", "1"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.86816929518775*^9, 3.868169325503978*^9}, {
   3.868169462928048*^9, 3.8681694794877234`*^9}, {3.8690096139605627`*^9, 
   3.869009623822521*^9}, {3.8690110033636847`*^9, 3.8690110081703367`*^9}, 
   3.8690119438512077`*^9, {3.8690125432609367`*^9, 3.869012575460663*^9}, {
   3.869012781996496*^9, 3.869012787536962*^9}, {3.8690141495155*^9, 
   3.8690141684965277`*^9}, {3.869015050319406*^9, 3.869015070543192*^9}, {
   3.8690166396416607`*^9, 3.869016644304433*^9}, {3.869017452855124*^9, 
   3.8690174545155*^9}, {3.879639224829295*^9, 3.879639228082115*^9}, 
   3.8796392883233213`*^9, {3.87964024700358*^9, 3.879640249883224*^9}, {
   3.9001441500965633`*^9, 3.9001441509241533`*^9}, {3.9039053806589117`*^9, 
   3.903905385997097*^9}, {3.9039097948285837`*^9, 3.903909797106483*^9}},
 CellLabel->
  "In[280]:=",ExpressionUUID->"8e0c406b-d438-4fa5-b493-b9675a8e3d66"],

Cell[CellGroupData[{

Cell[BoxData["numList"], "Input",
 CellLabel->
  "In[345]:=",ExpressionUUID->"868a31b3-2984-42ee-a8a5-24fac16deb33"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{"1", ",", "2", ",", "3"}], "]"}], "-", 
   RowBox[{"T", "[", 
    RowBox[{"2", ",", "1", ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9039128424244223`*^9, 3.903912891853857*^9}, 
   3.9039129436502943`*^9},
 CellLabel->
  "Out[345]=",ExpressionUUID->"e459001f-f54f-4096-8b54-4eb0f2316c43"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bpeff2", "=", 
  RowBox[{
   RowBox[{"GBinaryProduct", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"n", "-", "1"}], "]"}], "]"}], "//", 
   RowBox[{"Cases", "[", 
    RowBox[{"X", "[", 
     RowBox[{"f_", ",", "3"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"preNumerator", "/.", 
       RowBox[{
        RowBox[{"p", "[", "f__", "]"}], ":>", 
        RowBox[{"Total", "[", 
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], "]"}]}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", 
      RowBox[{"0", "/;", 
       RowBox[{"i", "<", 
        RowBox[{"n", "-", "1"}]}]}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"n", "-", "1"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"n", "-", "1"}], "]"}]}], "]"}], "->", 
     SuperscriptBox["m", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ExpandNCM", "/@", 
       RowBox[{"(", 
        RowBox[{"bpeff2", "/.", 
         RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
      RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"f__", ",", "i_"}], "]"}], ":>", 
      RowBox[{"0", "/;", 
       RowBox[{"i", "\[NotEqual]", "3"}]}]}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], "->", "1"}], "}"}]}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"/.", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
      RowBox[{"0", "/;", 
       RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", "n"}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PPList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"#", ",", 
       RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
    RowBox[{"X2Prop", "/@", 
     RowBox[{"(", "bpeff2", ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.903908001821203*^9, 3.903908032959531*^9}, {
   3.9039081657339354`*^9, 3.9039082293874702`*^9}, {3.903908293085688*^9, 
   3.903908332750951*^9}, {3.903908375455634*^9, 3.903908427593849*^9}, {
   3.9039086539624043`*^9, 3.903908682781887*^9}, {3.9039088672888002`*^9, 
   3.903908883012003*^9}, {3.903908941217854*^9, 3.903908952770527*^9}, 
   3.9039098037469893`*^9, {3.903910472705678*^9, 3.90391049919447*^9}, {
   3.903912847602496*^9, 3.903912939403632*^9}, {3.9039130335758867`*^9, 
   3.903913081220694*^9}},
 CellLabel->
  "In[365]:=",ExpressionUUID->"2727980c-4163-443f-b4d1-4afad39228d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"X", "[", 
   RowBox[{
    RowBox[{"X", "[", 
     RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9039081845626087`*^9, {3.903908218390181*^9, 3.9039082308201513`*^9}, {
   3.903908314555334*^9, 3.903908333362843*^9}, {3.903908384598239*^9, 
   3.903908428169779*^9}, {3.903908660028858*^9, 3.9039086832853193`*^9}, 
   3.9039089535439367`*^9, 3.903909809293215*^9, 3.9039105005519753`*^9, 
   3.903912857085614*^9, 3.9039128891767187`*^9, {3.90391294021871*^9, 
   3.90391295716632*^9}, 3.9039130819357843`*^9},
 CellLabel->
  "Out[365]=",ExpressionUUID->"051ce33a-1943-4483-909a-1cbeef522098"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["PPList"], "Input",
 CellChangeTimes->{{3.9039086403159246`*^9, 3.90390864190412*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"4ba94256-7216-4a73-a86e-5c0247f6732b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "2", ",", "3"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], "]"}]}]], ",", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "3"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "3", ",", "2"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "3", ",", "2"}], "]"}]}], "]"}]}]], ",", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"2", ",", "3"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "2", ",", "3"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], "]"}]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.903908631759035*^9, 3.903908685323618*^9}, 
   3.903908955769327*^9},
 CellLabel->
  "Out[271]=",ExpressionUUID->"cd0b1959-add0-4d3a-80ee-68a42b6ad392"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"amp4QED", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"numListL", ".", "PPList"}], "/.", 
      RowBox[{
       RowBox[{"p", "[", "f__", "]"}], ":>", 
       RowBox[{"Total", "[", 
        RowBox[{"p", "/@", 
         RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//.", "nicevs"}]}], "Input",
 CellChangeTimes->{{3.903908609974773*^9, 3.903908614464716*^9}, {
  3.903908993308043*^9, 3.9039090069185953`*^9}, {3.9039091071019497`*^9, 
  3.9039091496282663`*^9}, {3.9039105425643053`*^9, 3.903910543012004*^9}},
 CellLabel->
  "In[370]:=",ExpressionUUID->"f4a10925-d8e3-474f-9590-0dfc4be95d61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], 
    RowBox[{"4", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}]}]]}], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["p", "3"]}], 
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}]]}]], "Output",
 CellChangeTimes->{3.903909007528274*^9, 3.903909118358137*^9, 
  3.903909150193022*^9, 3.9039098126630096`*^9, 3.903910503643175*^9, 
  3.9039105443512774`*^9, 3.903912959705529*^9, 3.903913085146967*^9},
 CellLabel->
  "Out[371]=",ExpressionUUID->"ed79233b-4c50-4aea-aa04-9c125a6a9ab7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"amp4QED", "//", "expandFDirect"}], "//", "Expand"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Apart", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"%", "/.", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "2", "]"}], ",", 
             RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", "->", 
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"p", "[", "1", "]"}], ",", 
               RowBox[{"p", "[", "3", "]"}]}], "]"}]}], " ", "-", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], ",", 
              RowBox[{"p", "[", "2", "]"}]}], "]"}]}]}]}], " ", "//", 
         "Simplify"}], "//", "Expand"}], "//", "FullSimplify"}], "//", 
      "Expand"}], ",", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "]"}], "//", "Expand"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//.", "nicevs"}]}], "Input",
 CellChangeTimes->{{3.903910550339422*^9, 3.90391056077194*^9}, {
   3.9039105985671377`*^9, 3.903910642339898*^9}, {3.903910815706786*^9, 
   3.90391081665526*^9}, {3.90391084849594*^9, 3.9039108783988533`*^9}, 
   3.90391113092994*^9, 3.9039125131387787`*^9, {3.90391298117551*^9, 
   3.903912990355749*^9}, {3.903913107053011*^9, 3.903913108381424*^9}, {
   3.9039132830504007`*^9, 3.90391328376302*^9}, {3.9039133406193953`*^9, 
   3.903913378295236*^9}, {3.90391344466075*^9, 3.903913448299045*^9}},
 CellLabel->
  "In[391]:=",ExpressionUUID->"69b83e41-4e43-4593-8832-774cf6286c33"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "4"]}], " ", 
   RowBox[{
    SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
    SubscriptBox["\[Epsilon]", "2"]}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}]}], 
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}], 
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.903910553314588*^9, 3.903910561171556*^9}, {
   3.90391061755431*^9, 3.9039106427394533`*^9}, 3.903910817197569*^9, {
   3.903910869843514*^9, 3.9039108788335447`*^9}, 3.903911131565256*^9, 
   3.903912513983265*^9, {3.903912974598151*^9, 3.903912990839604*^9}, {
   3.903913090036447*^9, 3.903913108742487*^9}, 3.9039132845585623`*^9, {
   3.903913343650412*^9, 3.903913378785282*^9}, 3.9039134486670303`*^9, 
   3.903913487358741*^9},
 CellLabel->
  "Out[393]=",ExpressionUUID->"89b9f537-f347-4c9e-a9b6-5b1af2303af7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bpGRM", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", 
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}], ",", 
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "3"}], "]"}], ",", "2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AmpList0", "=", 
   RowBox[{
    RowBox[{"ExpandNCM", "/@", 
     RowBox[{"(", 
      RowBox[{"bpGRM", "/.", 
       RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
    RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AmpList", "=", 
   RowBox[{"AmpList0", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"Nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", "n"}], "]"}]}], ")"}]}]}]}], 
  ";"}]}], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"b3aef7c2-9eb6-4bd4-bb8c-e440525eec94"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"replace\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"p\\\", \\\"[\\\", \\\"1\\\", \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"p\\\", \\\"[\\\", \\\"2\\\", \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"p\\\", \\\"[\\\", \\\"3\\\", \\\"]\\\"}]}], \
\\\"}\\\"}], \\\",\\\", \\\"5\\\"}], \\\"]\\\"}], \\\"}\\\"}]\\) is neither a \
list of replacement rules nor a valid dispatch table, and so cannot be used \
for replacing.\"", 2, 21, 2, 33491438104809295611, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9039055231070557`*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"a68d2eeb-6153-4d82-8354-0e526199459b"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"replace\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"p\\\", \\\"[\\\", \\\"1\\\", \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"p\\\", \\\"[\\\", \\\"3\\\", \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"p\\\", \\\"[\\\", \\\"2\\\", \\\"]\\\"}]}], \
\\\"}\\\"}], \\\",\\\", \\\"5\\\"}], \\\"]\\\"}], \\\"}\\\"}]\\) is neither a \
list of replacement rules nor a valid dispatch table, and so cannot be used \
for replacing.\"", 2, 21, 3, 33491438104809295611, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9039055231176653`*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"65f5abfc-b3db-40a0-ae9b-5b321575eea2"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"replace\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"p\\\", \\\"[\\\", \\\"2\\\", \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"p\\\", \\\"[\\\", \\\"3\\\", \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"p\\\", \\\"[\\\", \\\"1\\\", \\\"]\\\"}]}], \
\\\"}\\\"}], \\\",\\\", \\\"5\\\"}], \\\"]\\\"}], \\\"}\\\"}]\\) is neither a \
list of replacement rules nor a valid dispatch table, and so cannot be used \
for replacing.\"", 2, 21, 4, 33491438104809295611, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.903905523122664*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"648d5a25-f7e5-4e0b-8953-792bdedaf1b1"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"ReplaceAll\\\", \
\\\"::\\\", \\\"reps\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 21, 5, 33491438104809295611, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.903905523127578*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"f6f0da5b-12ad-4be5-af06-357a3f821aeb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"preNumerator", "/.", 
          RowBox[{
           RowBox[{"p", "[", "f__", "]"}], ":>", 
           RowBox[{"Total", "[", 
            RowBox[{"p", "/@", 
             RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "i_", "]"}], ",", 
            RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", 
          RowBox[{"0", "/;", 
           RowBox[{"i", "<", "4"}]}]}]}], "/.", 
        RowBox[{
         RowBox[{"tr", "[", "__", "]"}], ":>", "1"}]}], "/.", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "4", "]"}], ",", 
          RowBox[{"p", "[", "4", "]"}]}], "]"}], "->", 
        RowBox[{"m", "^", "2"}]}]}], "/.", 
      RowBox[{
       RowBox[{"p", "[", "4", "]"}], "->", 
       RowBox[{"m", " ", 
        RowBox[{"p", "[", "0", "]"}]}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "\[Infinity]", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}], "//", "Normal"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{
    RowBox[{"p", "[", "0", "]"}], "->", "v"}]}], "//.", "nice"}]}], "Input",
 CellChangeTimes->{{3.900144157778719*^9, 3.900144335266465*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"f343c258-fb6b-4570-8c98-0cef92fe097d"],

Cell[BoxData[
 RowBox[{"m", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["p", "1"], "\[CenterDot]", 
          SubscriptBox["F", "3"], "\[CenterDot]", "v"}], "+", 
         RowBox[{
          SubscriptBox["p", "2"], "\[CenterDot]", 
          SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], ")"}], " ", 
       RowBox[{"v", "\[CenterDot]", 
        SubscriptBox["F", "1"], "\[CenterDot]", 
        SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"v", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "+", 
         RowBox[{"v", "\[CenterDot]", 
          SubscriptBox["p", "2"]}]}], ")"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
     RowBox[{"2", " ", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
     RowBox[{"2", " ", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.900144155607642*^9, 3.900144195383822*^9, {3.900144227540297*^9, 
   3.900144335655636*^9}},
 CellLabel->"Out[26]=",ExpressionUUID->"2242343d-c88e-4b2d-b38d-651dd8fec2c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
        SubscriptBox["F", "3"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}], " ", 
       RowBox[{
        SubscriptBox["p", "4"], "\[CenterDot]", 
        SubscriptBox["F", "1"], "\[CenterDot]", 
        SubscriptBox["F", "2"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}], " ", 
       RowBox[{"tr", "[", 
        RowBox[{
         SuperscriptBox["\[DoubleStruckT]", 
          SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
         SuperscriptBox["\[DoubleStruckT]", 
          SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["m", "2"]}], "+", 
         RowBox[{
          SubscriptBox["p", 
           RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
          SubscriptBox["p", 
           RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["m", "2"]}], "+", 
         RowBox[{
          SubscriptBox["p", 
           RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
          SubscriptBox["p", 
           RowBox[{"4", ",", "1", ",", "2"}]]}]}], ")"}]}]]}], "-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "3"}]]}], " ", 
      RowBox[{
       SubscriptBox["p", "4"], "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", 
       SubscriptBox["p", "4"]}], " ", 
      RowBox[{"tr", "[", 
       RowBox[{
        SuperscriptBox["\[DoubleStruckT]", 
         SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
        SuperscriptBox["\[DoubleStruckT]", 
         SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["m", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", 
          RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
         SubscriptBox["p", 
          RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["m", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", 
          RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
         SubscriptBox["p", 
          RowBox[{"4", ",", "1", ",", "3"}]]}]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "4"], "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", 
       SubscriptBox["p", "4"]}], " ", 
      RowBox[{"tr", "[", 
       RowBox[{
        SuperscriptBox["\[DoubleStruckT]", 
         SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
        SuperscriptBox["\[DoubleStruckT]", 
         SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}]]}], "/.", 
   RowBox[{
    RowBox[{"tr", "[", "__", "]"}], ":>", "1"}]}], "/.", 
  RowBox[{
   SubscriptBox["p", "4"], "->", 
   RowBox[{"m", " ", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.90014408686697*^9, 3.9001441046820717`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"fe4f7a50-668e-45d2-b1a9-5998ec047b45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      RowBox[{"(", 
       RowBox[{"m", " ", "v"}], ")"}]}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", " ", "v"}], ")"}], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      RowBox[{"(", 
       RowBox[{"m", " ", "v"}], ")"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
        SubscriptBox["p", 
         RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
        SubscriptBox["p", 
         RowBox[{"4", ",", "1", ",", "2"}]]}]}], ")"}]}]]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"m", " ", "v"}], ")"}], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{"m", " ", "v"}], ")"}]}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", " ", "v"}], ")"}], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    RowBox[{"(", 
     RowBox[{"m", " ", "v"}], ")"}]}], 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["m", "2"]}], "+", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}]}]]}]], "Output",
 CellChangeTimes->{{3.9001440927342033`*^9, 3.9001441083402843`*^9}},
 CellLabel->
  "Out[153]=",ExpressionUUID->"7c8912cb-f3c5-43b2-a42f-fb32c32a2406"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "BCJ", " ", "numerator", " ", "in", " ", "the", " ", 
    "DDM", " ", "basis"}], "*)"}], 
  RowBox[{"bcjNumerator", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", 
        RowBox[{
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"1", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"2", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"3", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"4", ",", "0"}], "]"}]}], "]"}], "/.", 
       RowBox[{"ET", ":>", "ET2F2s"}]}], "/.", 
      RowBox[{
       RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
       RowBox[{"tr", "[", 
        RowBox[{"f", ",", 
         RowBox[{"\[DoubleStruckT]", "^", 
          RowBox[{"\[DoubleStruckA]", "[", "n", "]"}]}]}], "]"}]}]}], "/.", 
     "rmzero"}], "//.", "nice"}]}]}]], "Input",
 CellChangeTimes->{{3.869012583259577*^9, 3.869012642019123*^9}, {
   3.869012755831274*^9, 3.8690127748427*^9}, {3.869015114946846*^9, 
   3.869015147413125*^9}, 3.869016800949233*^9, 3.869017266125304*^9, {
   3.8796392310275*^9, 3.879639232410425*^9}, 3.87963928377195*^9, {
   3.879640260333601*^9, 3.879640263097687*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"a68b14bc-f7bd-414a-9a1e-d3e12175bd0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{
      SubscriptBox["p", "4"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{"tr", "[", 
      RowBox[{
       SuperscriptBox["\[DoubleStruckT]", 
        SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
       SuperscriptBox["\[DoubleStruckT]", 
        SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
        SubscriptBox["p", 
         RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
        SubscriptBox["p", 
         RowBox[{"4", ",", "1", ",", "2"}]]}]}], ")"}]}]]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "2"}]]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["m", "2"]}], "+", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["m", "2"]}], "+", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}]}]]}]], "Output",
 CellChangeTimes->{{3.869012623545829*^9, 3.869012642546542*^9}, {
   3.869015123625246*^9, 3.869015148070993*^9}, 3.8690162711665688`*^9, 
   3.869016809694612*^9, 3.869017227590912*^9, 3.879640263933617*^9, 
   3.879640534317*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"e485a3c2-31b2-49ec-ac80-b24c28b8104d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "BCJ", " ", "numerator", " ", "beyond", " ", "the", " ", 
    "DDM", " ", "basis"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"inputOP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptCapitalK]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], ",", 
       RowBox[{"\[ScriptCapitalK]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], ",", 
       RowBox[{"\[ScriptCapitalK]", "[", 
        RowBox[{"3", ",", "1"}], "]"}], ",", 
       RowBox[{"\[ScriptCapitalK]", "[", 
        RowBox[{"4", ",", "0"}], "]"}]}], "}"}]}], " ", ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Set", " ", "input", " ", 
      RowBox[{"operators", ":", " ", 
       RowBox[{"\[ScriptCapitalK]", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}]}], ",", " ", 
     RowBox[{"i", " ", "is", " ", "the", " ", "particle", " ", "label"}], ",",
      " ", 
     RowBox[{"j", " ", "is", " ", "the", " ", "particle", " ", "spin"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"bcjNumG", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"bpeff2", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "/.", 
          RowBox[{"i_", ":>", 
           RowBox[{
            RowBox[{"inputOP", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/;", 
            RowBox[{"NumberQ", "[", "i", "]"}]}]}]}], "/.", 
         RowBox[{"X", "->", "\[CapitalOmega]"}]}], "/.", 
        RowBox[{"ET", ":>", "ET2F2s"}]}], "/.", 
       RowBox[{
        RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
        RowBox[{"tr", "[", 
         RowBox[{"f", ",", 
          RowBox[{"\[DoubleStruckT]", "^", 
           RowBox[{"\[DoubleStruckA]", "[", "n", "]"}]}]}], "]"}]}]}], "/.", 
      "rmzero"}], "//.", "nice"}]}]}]}]], "Input",
 CellChangeTimes->{{3.869012746718834*^9, 3.869012747249916*^9}, {
  3.8690127942815332`*^9, 3.869012969209333*^9}, {3.869013013154786*^9, 
  3.869013135838513*^9}, {3.8690163508006268`*^9, 3.869016371412492*^9}, {
  3.869016852619245*^9, 3.869016878194784*^9}, {3.8690172741565523`*^9, 
  3.869017304628399*^9}, {3.879639236417798*^9, 3.8796392379444857`*^9}, {
  3.879639273653534*^9, 3.879639276744267*^9}, {3.879640271953175*^9, 
  3.8796402747833138`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"bea366a9-2633-4840-ae7f-a7a54d48569a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{
      SubscriptBox["p", "4"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{"tr", "[", 
      RowBox[{
       SuperscriptBox["\[DoubleStruckT]", 
        SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
       SuperscriptBox["\[DoubleStruckT]", 
        SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
        SubscriptBox["p", 
         RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
        SubscriptBox["p", 
         RowBox[{"4", ",", "1", ",", "2"}]]}]}], ")"}]}]]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "2"}]]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["m", "2"]}], "+", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["m", "2"]}], "+", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}]}]]}]], "Output",
 CellChangeTimes->{{3.8690127449163322`*^9, 3.869012747738381*^9}, 
   3.8690129358282413`*^9, 3.86901296993078*^9, {3.869013013666724*^9, 
   3.869013091877961*^9}, {3.869013131478684*^9, 3.8690131364935503`*^9}, {
   3.86901635578586*^9, 3.869016371789898*^9}, {3.869016854806409*^9, 
   3.869016878626039*^9}, 3.869017235980132*^9, 3.879640275387042*^9, 
   3.879640536817809*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"5f00c7af-62ff-4655-8536-225541a2c966"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["five-pointCK two-scalar", "Section",
 CellChangeTimes->{{3.8564069369813757`*^9, 3.8564069411881237`*^9}, {
  3.856528505387108*^9, 3.856528508392273*^9}, {3.864366397575654*^9, 
  3.8643663998630047`*^9}, {3.864474113286031*^9, 3.864474114889228*^9}, {
  3.8644743167650013`*^9, 3.864474317970113*^9}, {3.864521747019771*^9, 
  3.864521765508876*^9}, {3.8671075959622383`*^9, 3.867107597914331*^9}, {
  3.8690095454796762`*^9, 3.869009579711589*^9}, {3.869013163073915*^9, 
  3.869013164565288*^9}, {3.86901640347239*^9, 
  3.8690164046186666`*^9}},ExpressionUUID->"64ee664b-fb04-4fa5-856f-\
f56107066b94"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bpeff2", "=", 
  RowBox[{"GBinaryProduct", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "1"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0Wkow3EcBvC1ouSFe3vhKMliOaI5Zk3+b1heKMZqEmPRNmXMhIU51mhN
yCi1xLxg7hzlSnnH0uYm5UqR9pfIHC8cv+/3xdPn3fPieSIr1AWVTAaDEUkC
XnK9eV2bNGWeyckDtdlLUrDJvoJae57ijUS+WZcIGn+06aBWVyYANyamNGDr
xCyqMChM4J3vuRlsMETYwAs9B1XPvtFglvgDlWz5vYKWfDY6pvwN6iYyuV7B
oM/KuAMsiZ1DtcueK7Dq+hudqS4O3CbWyOSo2moIA3dOLeiw60YNdg3doxlC
TdLRHk3d2tpQp6aDD165B1B54Sjvjyil7ChTVrYPXrxUoB+sek6pg6aiElvR
lNQQzwKRb0pA131la4tEB1uBfrFVkwdEZ8sZGlYUPg8Ka7mocdfjf0jkuQUB
YO8qVfxAzHwXoUrrRuUPMXd6F23ckpjAk3Q5qrsbiaZdZL8kVwz4+ahPButE
cWmgarD8yHxMesWdqJLxnd1PbPT6RdkSfnMo65n839cO/gPaxS1A
  "],
 CellLabel->"In[10]:=",ExpressionUUID->"6f47fbfa-d791-495e-b0ba-fb387023d70e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}], ",", "4"}], "]"}], 
   ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "3"}], "]"}], ",", "2"}], "]"}], ",", "4"}], "]"}], 
   ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", 
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", "4"}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "4"}], "]"}], ",", "3"}], "]"}], 
   ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "4"}], "]"}], ",", "2"}], "]"}], ",", "3"}], "]"}], 
   ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", 
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "4"}], "]"}]}], "]"}], ",", "3"}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"X", "[", 
      RowBox[{"3", ",", "4"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "3"}], "]"}], ",", "4"}], "]"}], ",", "2"}], "]"}], 
   ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "4"}], "]"}], ",", "3"}], "]"}], ",", "2"}], "]"}], 
   ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", 
       RowBox[{"X", "[", 
        RowBox[{"3", ",", "4"}], "]"}]}], "]"}], ",", "2"}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "3"}], "]"}], ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "4"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "4"}], "]"}], ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "3"}], "]"}], ",", "4"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "4"}], "]"}], ",", "3"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", 
       RowBox[{"X", "[", 
        RowBox[{"3", ",", "4"}], "]"}]}], "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8671077331244783`*^9, 3.867107770016876*^9}, 
   3.869008935636294*^9, 3.8690095244219227`*^9, 3.869009556476042*^9, 
   3.8690131908260717`*^9, 3.869016633048568*^9, 3.8796402426847277`*^9, 
   3.879640528439271*^9, 3.900144144489194*^9, 3.903904564818653*^9, 
   3.9039047731352177`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"c5d01494-6692-4c6f-b445-55e8c6e1dad6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bpeff2", "=", 
  RowBox[{"bpeff2", "//", 
   RowBox[{"Cases", "[", 
    RowBox[{"X", "[", 
     RowBox[{"f_", ",", "4"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.903904800256308*^9, 3.903904826655262*^9}, {
  3.903905356537299*^9, 3.903905363734603*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"9e5e29e6-9b31-4db4-8474-4f9ccf442af8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}], ",", "4"}], "]"}], 
   ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "3"}], "]"}], ",", "2"}], "]"}], ",", "4"}], "]"}], 
   ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", 
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", "4"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.903905364283153*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"6c991ade-8682-4037-98a3-782a08e83701"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "[", 
   RowBox[{
    RowBox[{"X", "[", 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}], ",", "4"}], "]"}], "//",
   "X2Prop"}]], "Input",
 CellChangeTimes->{{3.903907870252439*^9, 3.903907874851541*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"a629d670-8bc2-4f7b-93f3-135357b7787d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"1", ",", "2"}], "]"}], ",", 
    RowBox[{"p", "[", 
     RowBox[{"1", ",", "2"}], "]"}]}], "]"}], " ", 
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"1", ",", "2", ",", "3"}], "]"}], ",", 
    RowBox[{"p", "[", 
     RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.903907875282118*^9},
 CellLabel->
  "Out[189]=",ExpressionUUID->"9d722d59-be98-4052-8bee-4067af85f9d9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Generate", " ", "pre"}], "-", "numerator"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"preNumerator", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[FivePointedStar]", "[", 
         RowBox[{
          RowBox[{"\[ScriptCapitalK]", "[", 
           RowBox[{"1", ",", "1"}], "]"}], ",", 
          RowBox[{"\[ScriptCapitalK]", "[", 
           RowBox[{"2", ",", "1"}], "]"}], ",", 
          RowBox[{"\[ScriptCapitalK]", "[", 
           RowBox[{"3", ",", "1"}], "]"}], ",", 
          RowBox[{"\[ScriptCapitalK]", "[", 
           RowBox[{"4", ",", "0"}], "]"}]}], "]"}], "/.", 
        RowBox[{"ET", ":>", "ET2F2s"}]}], "/.", 
       RowBox[{
        RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
        RowBox[{"tr", "[", 
         RowBox[{"f", ",", 
          RowBox[{"\[DoubleStruckT]", "^", 
           RowBox[{"\[DoubleStruckA]", "[", "n", "]"}]}]}], "]"}]}]}], "/.", 
      "rmzero"}], "/.", 
     RowBox[{
      RowBox[{"tr", "[", "__", "]"}], ":>", "1"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.86816929518775*^9, 3.868169325503978*^9}, {
   3.868169462928048*^9, 3.8681694794877234`*^9}, {3.8690096139605627`*^9, 
   3.869009623822521*^9}, {3.8690110033636847`*^9, 3.8690110081703367`*^9}, 
   3.8690119438512077`*^9, {3.8690125432609367`*^9, 3.869012575460663*^9}, {
   3.869012781996496*^9, 3.869012787536962*^9}, {3.8690141495155*^9, 
   3.8690141684965277`*^9}, {3.869015050319406*^9, 3.869015070543192*^9}, {
   3.8690166396416607`*^9, 3.869016644304433*^9}, {3.869017452855124*^9, 
   3.8690174545155*^9}, {3.879639224829295*^9, 3.879639228082115*^9}, 
   3.8796392883233213`*^9, {3.87964024700358*^9, 3.879640249883224*^9}, {
   3.9001441500965633`*^9, 3.9001441509241533`*^9}, {3.9039053806589117`*^9, 
   3.903905385997097*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"38d53818-8fe7-43c7-81ad-4f0cb13dd74c"],

Cell[CellGroupData[{

Cell[BoxData["nod"], "Input",
 CellChangeTimes->{{3.9039083878870783`*^9, 3.903908388445941*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"a8b6a53e-2b41-439b-aa27-490fc3a6efbf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"F", "[", "3", "]"}], ",", 
         RowBox[{"p", "[", "4", "]"}]}], "]"}], "+", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"F", "[", "3", "]"}], ",", 
         RowBox[{"p", "[", "4", "]"}]}], "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "4", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"p", "[", "4", "]"}]}], "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "4", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "4", "]"}]}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "2", "]"}], ",", 
          RowBox[{"p", "[", "4", "]"}]}], "]"}]}]}], ")"}]}]]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"p", "[", "3", "]"}]}], "]"}], "+", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"p", "[", "4", "]"}]}], "]"}]}], ")"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "4", "]"}], ",", 
      RowBox[{"F", "[", "1", "]"}], ",", 
      RowBox[{"F", "[", "3", "]"}], ",", 
      RowBox[{"p", "[", "4", "]"}]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "4", "]"}]}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "3", "]"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "4", "]"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"p", "[", "4", "]"}]}], "]"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "4", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "3", "]"}], ",", 
     RowBox[{"p", "[", "4", "]"}]}], "]"}], 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["m", "2"]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"p", "[", "4", "]"}]}], "]"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.90390537713385*^9, 3.903905388507278*^9}, {
  3.9039083889015017`*^9, 3.903908430183988*^9}},
 CellLabel->
  "Out[245]=",ExpressionUUID->"63bdbc56-66f6-4f18-a087-958d650bcaf2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bpeff2", "=", 
  RowBox[{
   RowBox[{"GBinaryProduct", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"n", "-", "1"}], "]"}], "]"}], "//", 
   RowBox[{"Cases", "[", 
    RowBox[{"X", "[", 
     RowBox[{"f_", ",", "4"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"preNumerator", "/.", 
      RowBox[{
       RowBox[{"p", "[", "f__", "]"}], ":>", 
       RowBox[{"Total", "[", 
        RowBox[{"p", "/@", 
         RowBox[{"{", "f", "}"}]}], "]"}]}]}], ")"}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", "n"}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PPList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"#", ",", 
       RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
    RowBox[{"X2Prop", "/@", 
     RowBox[{"(", "bpeff2", ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.903908001821203*^9, 3.903908032959531*^9}, {
  3.9039081657339354`*^9, 3.9039082293874702`*^9}, {3.903908293085688*^9, 
  3.903908332750951*^9}, {3.903908375455634*^9, 3.903908427593849*^9}, {
  3.9039086539624043`*^9, 3.903908682781887*^9}, {3.9039088672888002`*^9, 
  3.903908883012003*^9}, {3.903908941217854*^9, 3.903908952770527*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"6af137b1-c300-4511-90ef-7e78dccaad4e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}], ",", "4"}], "]"}], 
   ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "3"}], "]"}], ",", "2"}], "]"}], ",", "4"}], "]"}], 
   ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", 
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", "4"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.9039081845626087`*^9, {3.903908218390181*^9, 3.9039082308201513`*^9}, {
   3.903908314555334*^9, 3.903908333362843*^9}, {3.903908384598239*^9, 
   3.903908428169779*^9}, {3.903908660028858*^9, 3.9039086832853193`*^9}, 
   3.9039089535439367`*^9},
 CellLabel->
  "Out[265]=",ExpressionUUID->"0b60448b-bc26-4098-980f-5f794f96af86"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["PPList"], "Input",
 CellChangeTimes->{{3.9039086403159246`*^9, 3.90390864190412*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"61aa0324-586b-4c9d-bba9-0722e1155ca7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "2", ",", "3"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], "]"}]}]], ",", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "3"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "3", ",", "2"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "3", ",", "2"}], "]"}]}], "]"}]}]], ",", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"2", ",", "3"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "2", ",", "3"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], "]"}]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.903908631759035*^9, 3.903908685323618*^9}, 
   3.903908955769327*^9},
 CellLabel->
  "Out[271]=",ExpressionUUID->"f14db527-2264-411a-9486-68a422b26ec4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"amp5QED", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"numListL", ".", "PPList"}], "/.", 
      RowBox[{
       RowBox[{"p", "[", "f__", "]"}], ":>", 
       RowBox[{"Total", "[", 
        RowBox[{"p", "/@", 
         RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//.", "nicevs"}]}], "Input",
 CellChangeTimes->{{3.903908609974773*^9, 3.903908614464716*^9}, {
  3.903908993308043*^9, 3.9039090069185953`*^9}, {3.9039091071019497`*^9, 
  3.9039091496282663`*^9}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"d5ef5cd2-0033-4ab3-bad7-271f3e282c52"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{
      SubscriptBox["p", "4"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}]}], 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["p", "2"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "4"]}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["p", "2"], "\[CenterDot]", 
         SubscriptBox["p", "4"]}]}]}], ")"}]}]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "3"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "3"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "3"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "3"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "3"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "3"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "3"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "3"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "4"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["p", "4"]}], 
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "4"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["p", "4"]}], 
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.903909007528274*^9, 3.903909118358137*^9, 
  3.903909150193022*^9},
 CellLabel->
  "Out[276]=",ExpressionUUID->"876c7c6d-59ef-4910-bb5d-9f8dfda56e07"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bpGRM", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", 
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}], ",", 
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "3"}], "]"}], ",", "2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AmpList0", "=", 
   RowBox[{
    RowBox[{"ExpandNCM", "/@", 
     RowBox[{"(", 
      RowBox[{"bpGRM", "/.", 
       RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
    RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AmpList", "=", 
   RowBox[{"AmpList0", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"Nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", "n"}], "]"}]}], ")"}]}]}]}], 
  ";"}]}], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"a9362f96-9a64-4f8e-80bb-4a4d489e4023"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"replace\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"p\\\", \\\"[\\\", \\\"1\\\", \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"p\\\", \\\"[\\\", \\\"2\\\", \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"p\\\", \\\"[\\\", \\\"3\\\", \\\"]\\\"}]}], \
\\\"}\\\"}], \\\",\\\", \\\"5\\\"}], \\\"]\\\"}], \\\"}\\\"}]\\) is neither a \
list of replacement rules nor a valid dispatch table, and so cannot be used \
for replacing.\"", 2, 21, 2, 33491438104809295611, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9039055231070557`*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"44de8091-11ae-4846-99be-ce52a3049b05"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"replace\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"p\\\", \\\"[\\\", \\\"1\\\", \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"p\\\", \\\"[\\\", \\\"3\\\", \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"p\\\", \\\"[\\\", \\\"2\\\", \\\"]\\\"}]}], \
\\\"}\\\"}], \\\",\\\", \\\"5\\\"}], \\\"]\\\"}], \\\"}\\\"}]\\) is neither a \
list of replacement rules nor a valid dispatch table, and so cannot be used \
for replacing.\"", 2, 21, 3, 33491438104809295611, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9039055231176653`*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"c13e3720-336d-4878-96c7-e430e612f715"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"replace\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"p\\\", \\\"[\\\", \\\"2\\\", \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"p\\\", \\\"[\\\", \\\"3\\\", \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"p\\\", \\\"[\\\", \\\"1\\\", \\\"]\\\"}]}], \
\\\"}\\\"}], \\\",\\\", \\\"5\\\"}], \\\"]\\\"}], \\\"}\\\"}]\\) is neither a \
list of replacement rules nor a valid dispatch table, and so cannot be used \
for replacing.\"", 2, 21, 4, 33491438104809295611, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.903905523122664*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"d843e83b-a17c-4153-bde0-bc88259eb2cc"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"ReplaceAll\\\", \
\\\"::\\\", \\\"reps\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 21, 5, 33491438104809295611, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.903905523127578*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"61f2690b-1562-4b02-8e1e-ee9261b5c181"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"preNumerator", "/.", 
          RowBox[{
           RowBox[{"p", "[", "f__", "]"}], ":>", 
           RowBox[{"Total", "[", 
            RowBox[{"p", "/@", 
             RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "i_", "]"}], ",", 
            RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", 
          RowBox[{"0", "/;", 
           RowBox[{"i", "<", "4"}]}]}]}], "/.", 
        RowBox[{
         RowBox[{"tr", "[", "__", "]"}], ":>", "1"}]}], "/.", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "4", "]"}], ",", 
          RowBox[{"p", "[", "4", "]"}]}], "]"}], "->", 
        RowBox[{"m", "^", "2"}]}]}], "/.", 
      RowBox[{
       RowBox[{"p", "[", "4", "]"}], "->", 
       RowBox[{"m", " ", 
        RowBox[{"p", "[", "0", "]"}]}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "\[Infinity]", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}], "//", "Normal"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{
    RowBox[{"p", "[", "0", "]"}], "->", "v"}]}], "//.", "nice"}]}], "Input",
 CellChangeTimes->{{3.900144157778719*^9, 3.900144335266465*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"7be5350d-64c7-45f9-ad08-539630edbb93"],

Cell[BoxData[
 RowBox[{"m", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["p", "1"], "\[CenterDot]", 
          SubscriptBox["F", "3"], "\[CenterDot]", "v"}], "+", 
         RowBox[{
          SubscriptBox["p", "2"], "\[CenterDot]", 
          SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], ")"}], " ", 
       RowBox[{"v", "\[CenterDot]", 
        SubscriptBox["F", "1"], "\[CenterDot]", 
        SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"v", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "+", 
         RowBox[{"v", "\[CenterDot]", 
          SubscriptBox["p", "2"]}]}], ")"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
     RowBox[{"2", " ", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
     RowBox[{"2", " ", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.900144155607642*^9, 3.900144195383822*^9, {3.900144227540297*^9, 
   3.900144335655636*^9}},
 CellLabel->"Out[26]=",ExpressionUUID->"b964cd33-7eff-4f2b-81d1-ee74348e5314"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
        SubscriptBox["F", "3"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}], " ", 
       RowBox[{
        SubscriptBox["p", "4"], "\[CenterDot]", 
        SubscriptBox["F", "1"], "\[CenterDot]", 
        SubscriptBox["F", "2"], "\[CenterDot]", 
        SubscriptBox["p", "4"]}], " ", 
       RowBox[{"tr", "[", 
        RowBox[{
         SuperscriptBox["\[DoubleStruckT]", 
          SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
         SuperscriptBox["\[DoubleStruckT]", 
          SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["m", "2"]}], "+", 
         RowBox[{
          SubscriptBox["p", 
           RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
          SubscriptBox["p", 
           RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["m", "2"]}], "+", 
         RowBox[{
          SubscriptBox["p", 
           RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
          SubscriptBox["p", 
           RowBox[{"4", ",", "1", ",", "2"}]]}]}], ")"}]}]]}], "-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "3"}]]}], " ", 
      RowBox[{
       SubscriptBox["p", "4"], "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", 
       SubscriptBox["p", "4"]}], " ", 
      RowBox[{"tr", "[", 
       RowBox[{
        SuperscriptBox["\[DoubleStruckT]", 
         SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
        SuperscriptBox["\[DoubleStruckT]", 
         SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["m", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", 
          RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
         SubscriptBox["p", 
          RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["m", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", 
          RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
         SubscriptBox["p", 
          RowBox[{"4", ",", "1", ",", "3"}]]}]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "4"], "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", 
       SubscriptBox["p", "4"]}], " ", 
      RowBox[{"tr", "[", 
       RowBox[{
        SuperscriptBox["\[DoubleStruckT]", 
         SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
        SuperscriptBox["\[DoubleStruckT]", 
         SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}]]}], "/.", 
   RowBox[{
    RowBox[{"tr", "[", "__", "]"}], ":>", "1"}]}], "/.", 
  RowBox[{
   SubscriptBox["p", "4"], "->", 
   RowBox[{"m", " ", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.90014408686697*^9, 3.9001441046820717`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"f3d5bcf1-a2f3-4ac3-8ebe-e913c7967d13"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      RowBox[{"(", 
       RowBox[{"m", " ", "v"}], ")"}]}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", " ", "v"}], ")"}], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      RowBox[{"(", 
       RowBox[{"m", " ", "v"}], ")"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
        SubscriptBox["p", 
         RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
        SubscriptBox["p", 
         RowBox[{"4", ",", "1", ",", "2"}]]}]}], ")"}]}]]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"m", " ", "v"}], ")"}], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{"m", " ", "v"}], ")"}]}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", " ", "v"}], ")"}], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    RowBox[{"(", 
     RowBox[{"m", " ", "v"}], ")"}]}], 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["m", "2"]}], "+", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}]}]]}]], "Output",
 CellChangeTimes->{{3.9001440927342033`*^9, 3.9001441083402843`*^9}},
 CellLabel->
  "Out[153]=",ExpressionUUID->"98317660-7bae-499c-a977-e93b0281ad59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "BCJ", " ", "numerator", " ", "in", " ", "the", " ", 
    "DDM", " ", "basis"}], "*)"}], 
  RowBox[{"bcjNumerator", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", 
        RowBox[{
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"1", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"2", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"3", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"4", ",", "0"}], "]"}]}], "]"}], "/.", 
       RowBox[{"ET", ":>", "ET2F2s"}]}], "/.", 
      RowBox[{
       RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
       RowBox[{"tr", "[", 
        RowBox[{"f", ",", 
         RowBox[{"\[DoubleStruckT]", "^", 
          RowBox[{"\[DoubleStruckA]", "[", "n", "]"}]}]}], "]"}]}]}], "/.", 
     "rmzero"}], "//.", "nice"}]}]}]], "Input",
 CellChangeTimes->{{3.869012583259577*^9, 3.869012642019123*^9}, {
   3.869012755831274*^9, 3.8690127748427*^9}, {3.869015114946846*^9, 
   3.869015147413125*^9}, 3.869016800949233*^9, 3.869017266125304*^9, {
   3.8796392310275*^9, 3.879639232410425*^9}, 3.87963928377195*^9, {
   3.879640260333601*^9, 3.879640263097687*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"3665a4bf-2a22-46a6-833b-2c612a3a69d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{
      SubscriptBox["p", "4"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{"tr", "[", 
      RowBox[{
       SuperscriptBox["\[DoubleStruckT]", 
        SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
       SuperscriptBox["\[DoubleStruckT]", 
        SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
        SubscriptBox["p", 
         RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
        SubscriptBox["p", 
         RowBox[{"4", ",", "1", ",", "2"}]]}]}], ")"}]}]]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "2"}]]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["m", "2"]}], "+", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["m", "2"]}], "+", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}]}]]}]], "Output",
 CellChangeTimes->{{3.869012623545829*^9, 3.869012642546542*^9}, {
   3.869015123625246*^9, 3.869015148070993*^9}, 3.8690162711665688`*^9, 
   3.869016809694612*^9, 3.869017227590912*^9, 3.879640263933617*^9, 
   3.879640534317*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"a282a4d0-2e55-4ed9-a98b-53bb6516a692"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "BCJ", " ", "numerator", " ", "beyond", " ", "the", " ", 
    "DDM", " ", "basis"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"inputOP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptCapitalK]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], ",", 
       RowBox[{"\[ScriptCapitalK]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], ",", 
       RowBox[{"\[ScriptCapitalK]", "[", 
        RowBox[{"3", ",", "1"}], "]"}], ",", 
       RowBox[{"\[ScriptCapitalK]", "[", 
        RowBox[{"4", ",", "0"}], "]"}]}], "}"}]}], " ", ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Set", " ", "input", " ", 
      RowBox[{"operators", ":", " ", 
       RowBox[{"\[ScriptCapitalK]", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}]}], ",", " ", 
     RowBox[{"i", " ", "is", " ", "the", " ", "particle", " ", "label"}], ",",
      " ", 
     RowBox[{"j", " ", "is", " ", "the", " ", "particle", " ", "spin"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"bcjNumG", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"bpeff2", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "/.", 
          RowBox[{"i_", ":>", 
           RowBox[{
            RowBox[{"inputOP", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/;", 
            RowBox[{"NumberQ", "[", "i", "]"}]}]}]}], "/.", 
         RowBox[{"X", "->", "\[CapitalOmega]"}]}], "/.", 
        RowBox[{"ET", ":>", "ET2F2s"}]}], "/.", 
       RowBox[{
        RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
        RowBox[{"tr", "[", 
         RowBox[{"f", ",", 
          RowBox[{"\[DoubleStruckT]", "^", 
           RowBox[{"\[DoubleStruckA]", "[", "n", "]"}]}]}], "]"}]}]}], "/.", 
      "rmzero"}], "//.", "nice"}]}]}]}]], "Input",
 CellChangeTimes->{{3.869012746718834*^9, 3.869012747249916*^9}, {
  3.8690127942815332`*^9, 3.869012969209333*^9}, {3.869013013154786*^9, 
  3.869013135838513*^9}, {3.8690163508006268`*^9, 3.869016371412492*^9}, {
  3.869016852619245*^9, 3.869016878194784*^9}, {3.8690172741565523`*^9, 
  3.869017304628399*^9}, {3.879639236417798*^9, 3.8796392379444857`*^9}, {
  3.879639273653534*^9, 3.879639276744267*^9}, {3.879640271953175*^9, 
  3.8796402747833138`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"5ba17ce1-7990-4605-8f18-971cabb9b6bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{
      SubscriptBox["p", "4"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{"tr", "[", 
      RowBox[{
       SuperscriptBox["\[DoubleStruckT]", 
        SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
       SuperscriptBox["\[DoubleStruckT]", 
        SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
        SubscriptBox["p", 
         RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
        SubscriptBox["p", 
         RowBox[{"4", ",", "1", ",", "2"}]]}]}], ")"}]}]]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "2"}]]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1"}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
       SubscriptBox["p", 
        RowBox[{"4", ",", "1", ",", "3"}]]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["m", "2"]}], "+", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "4"]], ",", 
      SuperscriptBox["\[DoubleStruckT]", 
       SubscriptBox["\[DoubleStruckA]", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["m", "2"]}], "+", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}]}]]}]], "Output",
 CellChangeTimes->{{3.8690127449163322`*^9, 3.869012747738381*^9}, 
   3.8690129358282413`*^9, 3.86901296993078*^9, {3.869013013666724*^9, 
   3.869013091877961*^9}, {3.869013131478684*^9, 3.8690131364935503`*^9}, {
   3.86901635578586*^9, 3.869016371789898*^9}, {3.869016854806409*^9, 
   3.869016878626039*^9}, 3.869017235980132*^9, 3.879640275387042*^9, 
   3.879640536817809*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"73149c02-ebbd-4cdf-a55e-2dec7d76ae86"]
}, Open  ]]
}, Closed]]
},
WindowSize->{1264, 870},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.25 Inherited,
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"37b6de1f-9a11-4454-a12e-725d44bf4cdf"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info-a32ac0e0-8683-4895-a907-2832647d6b92"->{
  Cell[54364, 1304, 11930, 292, 105, "Print",ExpressionUUID->"cc47fdcf-3cd0-49d8-aa74-49a31feaca82",
   CellTags->"Info-a32ac0e0-8683-4895-a907-2832647d6b92"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info-a32ac0e0-8683-4895-a907-2832647d6b92", 357992, 9935}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 861, 17, 100, "Input",ExpressionUUID->"8b241212-cb5e-4c49-a1af-98e2bcd66219"],
Cell[1444, 41, 2485, 35, 51, "Output",ExpressionUUID->"a5f81c39-a20b-470b-849c-79822b0a5435"],
Cell[3932, 78, 760, 16, 159, "Print",ExpressionUUID->"a0402c5a-8c71-4c9a-900f-166a6104d516"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4729, 99, 1025, 23, 123, "Input",ExpressionUUID->"6a6bb66f-8473-455a-bd23-80e7f0254686"],
Cell[CellGroupData[{
Cell[5779, 126, 665, 11, 29, "Print",ExpressionUUID->"962706e2-8abe-460b-8957-7c6623f68bf0"],
Cell[6447, 139, 677, 11, 29, "Print",ExpressionUUID->"1750d722-cbc7-45b0-aaf8-abf3ce87f0bc"],
Cell[7127, 152, 687, 12, 29, "Print",ExpressionUUID->"b426430e-645b-437e-bbdb-65354f74716a"],
Cell[7817, 166, 686, 12, 29, "Print",ExpressionUUID->"af4d8d18-723f-46e9-a15b-a6a5006a8941"]
}, Open  ]]
}, Open  ]],
Cell[8530, 182, 553, 13, 104, "Input",ExpressionUUID->"ca79a261-126a-4970-a7e6-9cc5f4f13621"],
Cell[CellGroupData[{
Cell[9108, 199, 198, 4, 51, "Input",ExpressionUUID->"09aa9921-dc9d-4005-9867-5b17dffafd4b"],
Cell[9309, 205, 45052, 1097, 1048, "Output",ExpressionUUID->"bbd91620-4e4c-4552-8722-19eaba98aceb"],
Cell[54364, 1304, 11930, 292, 105, "Print",ExpressionUUID->"cc47fdcf-3cd0-49d8-aa74-49a31feaca82",
 CellTags->"Info-a32ac0e0-8683-4895-a907-2832647d6b92"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66331, 1601, 157, 3, 87, "Section",ExpressionUUID->"d3d4ced6-cccd-443d-9493-a11ffd0a2e32"],
Cell[CellGroupData[{
Cell[66513, 1608, 169, 3, 42, "Subsection",ExpressionUUID->"4bd1fb5d-59c6-4eee-afb5-56504466d7c9"],
Cell[66685, 1613, 787, 19, 51, "Input",ExpressionUUID->"a6f33657-13e1-4cba-8924-27abde55a71c"],
Cell[67475, 1634, 1582, 47, 234, "Input",ExpressionUUID->"aa256fba-4b71-4d21-a126-4c9a39bb24e9"],
Cell[69060, 1683, 700, 17, 104, "Input",ExpressionUUID->"e40cfd72-b14b-4321-ba7f-1664c33f5a0d"],
Cell[69763, 1702, 852, 21, 104, "Input",ExpressionUUID->"5cd03f09-4ddc-4942-95f3-5a69f70271e0"],
Cell[70618, 1725, 573, 13, 78, "Input",ExpressionUUID->"4e98a90b-2474-459d-bf7b-ef6fa4a15dbd"],
Cell[71194, 1740, 2640, 78, 260, "Input",ExpressionUUID->"4017ebd9-7c0e-4fdc-b498-164358f1042c"],
Cell[73837, 1820, 798, 21, 78, "Input",ExpressionUUID->"476c402a-2414-4445-89a3-484638728559"],
Cell[74638, 1843, 5952, 151, 260, "Input",ExpressionUUID->"95ea9518-c905-4b23-bbdb-aec1d2c138cc"],
Cell[80593, 1996, 1821, 45, 156, "Input",ExpressionUUID->"63b495bf-5f25-42be-b6eb-d92ab9b63958"],
Cell[82417, 2043, 1173, 30, 104, "Input",ExpressionUUID->"a3a4be0d-bc29-45f6-b509-80aa9b35e746"],
Cell[83593, 2075, 2351, 72, 182, "Input",ExpressionUUID->"db32a883-9994-4512-8a32-712ed53230c6"],
Cell[85947, 2149, 1197, 35, 156, "Input",ExpressionUUID->"16d45bd6-b4a8-4347-8488-3ed2148e2ae8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87181, 2189, 164, 3, 42, "Subsection",ExpressionUUID->"c528d33f-d8eb-47b9-a0dd-af5e6f1888af"],
Cell[87348, 2194, 7163, 196, 572, "Input",ExpressionUUID->"8ba90879-f9a7-46f3-84f1-d104f8e60d30"],
Cell[94514, 2392, 1749, 52, 156, "Input",ExpressionUUID->"3f54f243-2649-4daf-8533-7583ab797d2f"],
Cell[96266, 2446, 4531, 124, 468, "Input",ExpressionUUID->"b21d6b70-b445-4ba6-b097-a7cebb2c2297"],
Cell[100800, 2572, 3427, 92, 364, "Input",ExpressionUUID->"75282d94-b2ec-4bbc-be5f-0c2e506993d5"],
Cell[104230, 2666, 2468, 71, 338, "Input",ExpressionUUID->"3ed81259-0a5f-4929-a56c-1608585fb04c"],
Cell[106701, 2739, 2816, 82, 338, "Input",ExpressionUUID->"15e46d7d-06a1-4c52-b273-8fdbddadcddd"],
Cell[109520, 2823, 1310, 30, 130, "Input",ExpressionUUID->"37a7230a-cf85-40af-8127-779eeb703e02"],
Cell[110833, 2855, 3076, 88, 435, "Input",ExpressionUUID->"86386577-80ea-474c-9d71-cb6827863068"],
Cell[113912, 2945, 1227, 32, 104, "Input",ExpressionUUID->"5d9efe21-4964-4b4f-8173-8f9da05b2cf0"],
Cell[115142, 2979, 611, 16, 104, "Input",ExpressionUUID->"dcfc64fa-580c-4dd3-b67b-203252d968ff"],
Cell[115756, 2997, 2225, 56, 338, "Input",ExpressionUUID->"677c8a38-5351-4f01-ae82-959e2da73f35"],
Cell[117984, 3055, 13005, 339, 806, "Input",ExpressionUUID->"7a34d1ed-c095-4938-9235-1e63123ea8dd"],
Cell[130992, 3396, 3197, 86, 373, "Input",ExpressionUUID->"025fe46f-98bd-4bd4-8417-808da771bab6"],
Cell[134192, 3484, 2898, 81, 373, "Input",ExpressionUUID->"85db6638-7940-4c54-88f8-d8cbc248dc32"],
Cell[137093, 3567, 7457, 144, 399, "Input",ExpressionUUID->"398da8e0-fbb6-431b-b938-13c4d298238b"]
}, Closed]],
Cell[CellGroupData[{
Cell[144587, 3716, 170, 3, 41, "Subsection",ExpressionUUID->"a975fd09-0582-429c-bebe-89aa18c44e6e"],
Cell[144760, 3721, 2841, 87, 208, "Input",ExpressionUUID->"9e5a9a6e-6080-484e-aa70-e86924b7da10"],
Cell[147604, 3810, 14241, 396, 1482, "Input",ExpressionUUID->"85381c0e-28b0-4e61-bcdf-b197d6083f5e"]
}, Closed]],
Cell[CellGroupData[{
Cell[161882, 4211, 173, 3, 41, "Subsection",ExpressionUUID->"1964b7a2-060f-4add-9c33-5f6644c35245"],
Cell[162058, 4216, 2008, 55, 182, "Input",ExpressionUUID->"79babd0c-3512-4340-8232-e83ba8c12033"],
Cell[164069, 4273, 4518, 119, 364, "Input",ExpressionUUID->"c9ebaf50-9b3d-48f6-890b-98dde6d47adb"]
}, Closed]],
Cell[CellGroupData[{
Cell[168624, 4397, 159, 3, 41, "Subsection",ExpressionUUID->"40cf7ca5-731b-49c8-9c05-0684b3dc1ba2"],
Cell[168786, 4402, 6804, 194, 728, "Input",ExpressionUUID->"3f771a88-a22c-4ad4-98c4-bf799257a288"],
Cell[175593, 4598, 1460, 32, 130, "Input",ExpressionUUID->"e204db8b-2809-48fb-be8f-268b90ce9dc2"],
Cell[177056, 4632, 1266, 37, 156, "Input",ExpressionUUID->"da927357-f46e-407a-9b0a-56fdfe11d829"],
Cell[178325, 4671, 2943, 67, 234, "Input",ExpressionUUID->"862aa9f1-067d-4c15-bc1c-c2635cfe2b7c"],
Cell[181271, 4740, 6107, 171, 416, "Input",ExpressionUUID->"a19e5a8e-8ac2-43c2-83e6-b9313c1e10b8"],
Cell[187381, 4913, 689, 16, 99, "Input",ExpressionUUID->"b6e0f9c9-b6e2-449c-8c19-c1e043de40f5"],
Cell[188073, 4931, 5231, 137, 497, "Input",ExpressionUUID->"b829f322-2824-4e19-a081-6df18bc367f5"],
Cell[193307, 5070, 2161, 62, 243, "Input",ExpressionUUID->"e7497423-7770-40aa-bb74-b4be0294df1f"],
Cell[195471, 5134, 1033, 27, 130, "Input",ExpressionUUID->"137f7a93-d896-415d-bb1e-f3ce16b6a8ea"],
Cell[196507, 5163, 5368, 137, 560, "Input",ExpressionUUID->"b708a7a6-63f3-4625-b102-0cebf08b0332"],
Cell[201878, 5302, 3943, 95, 462, "Input",ExpressionUUID->"e6380e8f-8cd3-484f-becf-14b738e64127"]
}, Closed]],
Cell[CellGroupData[{
Cell[205858, 5402, 174, 3, 41, "Subsection",ExpressionUUID->"d7d4b682-367d-4623-bda5-17f1363186ad"],
Cell[206035, 5407, 1145, 32, 104, "Input",ExpressionUUID->"9843905e-2c94-48d1-8581-954938700b5d"],
Cell[207183, 5441, 11379, 303, 1136, "Input",ExpressionUUID->"fff81519-03fe-4998-a657-8f731fa3af53"],
Cell[218565, 5746, 553, 13, 78, "Input",ExpressionUUID->"b9731d42-99cc-42e5-8ef3-f8e43b62d601"],
Cell[219121, 5761, 713, 15, 78, "Input",ExpressionUUID->"94bcb61a-2fdb-4f39-adf8-b6f4e3d676f1"],
Cell[219837, 5778, 3929, 119, 390, "Input",ExpressionUUID->"fc9203ff-b546-4131-a912-64f29b1d18fb"],
Cell[223769, 5899, 1912, 55, 234, "Input",ExpressionUUID->"fb871dec-8df0-4419-b039-94062df49d6a"],
Cell[225684, 5956, 1323, 39, 104, "Input",ExpressionUUID->"700aa801-4511-4d25-8bfc-87c6523334ba"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[227056, 6001, 664, 10, 68, "Section",ExpressionUUID->"f3c55150-e668-44e7-898f-cd9d17d0534a"],
Cell[CellGroupData[{
Cell[227745, 6015, 1970, 31, 78, "Input",ExpressionUUID->"604299c3-616b-47e8-bdaf-2e37fad2362c"],
Cell[229718, 6048, 836, 21, 51, "Output",ExpressionUUID->"8bfc06c3-7dfc-40cb-b3dd-3a1194f7db06"]
}, Open  ]],
Cell[CellGroupData[{
Cell[230591, 6074, 396, 9, 51, "Input",ExpressionUUID->"148e3d5e-839f-42c4-b0e6-b2d694807745"],
Cell[230990, 6085, 305, 8, 51, "Output",ExpressionUUID->"30619f31-4572-4bd6-b6b5-bc6bfc1bb3db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[231332, 6098, 375, 11, 51, "Input",ExpressionUUID->"171b5c70-3e5b-4c0f-ac2b-e87f2675e90f"],
Cell[231710, 6111, 527, 16, 51, "Output",ExpressionUUID->"ec615f86-9e96-4bf9-a8f2-722646cf3485"]
}, Open  ]],
Cell[232252, 6130, 1909, 42, 78, "Input",ExpressionUUID->"8e0c406b-d438-4fa5-b493-b9675a8e3d66"],
Cell[CellGroupData[{
Cell[234186, 6176, 116, 2, 51, "Input",ExpressionUUID->"868a31b3-2984-42ee-a8a5-24fac16deb33"],
Cell[234305, 6180, 380, 10, 51, "Output",ExpressionUUID->"e459001f-f54f-4096-8b54-4eb0f2316c43"]
}, Open  ]],
Cell[CellGroupData[{
Cell[234722, 6195, 3473, 102, 208, "Input",ExpressionUUID->"2727980c-4163-443f-b4d1-4afad39228d1"],
Cell[238198, 6299, 680, 14, 51, "Output",ExpressionUUID->"051ce33a-1943-4483-909a-1cbeef522098"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238915, 6318, 182, 3, 51, "Input",ExpressionUUID->"4ba94256-7216-4a73-a86e-5c0247f6732b"],
Cell[239100, 6323, 1566, 49, 121, "Output",ExpressionUUID->"cd0b1959-add0-4d3a-80ee-68a42b6ad392"]
}, Open  ]],
Cell[CellGroupData[{
Cell[240703, 6377, 879, 23, 78, "Input",ExpressionUUID->"f4a10925-d8e3-474f-9590-0dfc4be95d61"],
Cell[241585, 6402, 1170, 33, 72, "Output",ExpressionUUID->"ed79233b-4c50-4aea-aa04-9c125a6a9ab7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242792, 6440, 1791, 45, 130, "Input",ExpressionUUID->"69b83e41-4e43-4593-8832-774cf6286c33"],
Cell[244586, 6487, 2466, 74, 72, "Output",ExpressionUUID->"89b9f537-f347-4c9e-a9b6-5b1af2303af7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247089, 6566, 1238, 39, 104, "Input",ExpressionUUID->"b3aef7c2-9eb6-4bd4-bb8c-e440525eec94"],
Cell[248330, 6607, 761, 14, 35, "Message",ExpressionUUID->"a68d2eeb-6153-4d82-8354-0e526199459b"],
Cell[249094, 6623, 761, 14, 35, "Message",ExpressionUUID->"65f5abfc-b3db-40a0-ae9b-5b321575eea2"],
Cell[249858, 6639, 759, 14, 35, "Message",ExpressionUUID->"648d5a25-f7e5-4e0b-8953-792bdedaf1b1"],
Cell[250620, 6655, 454, 10, 35, "Message",ExpressionUUID->"f6f0da5b-12ad-4be5-af06-357a3f821aeb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[251111, 6670, 1477, 43, 104, "Input",ExpressionUUID->"f343c258-fb6b-4570-8c98-0cef92fe097d"],
Cell[252591, 6715, 1997, 55, 72, "Output",ExpressionUUID->"2242343d-c88e-4b2d-b38d-651dd8fec2c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[254625, 6775, 3696, 108, 111, "Input",ExpressionUUID->"fe4f7a50-668e-45d2-b1a9-5998ec047b45"],
Cell[258324, 6885, 2789, 89, 79, "Output",ExpressionUUID->"7c8912cb-f3c5-43b2-a42f-fb32c32a2406"]
}, Open  ]],
Cell[CellGroupData[{
Cell[261150, 6979, 1428, 34, 78, "Input",ExpressionUUID->"a68b14bc-f7bd-414a-9a1e-d3e12175bd0c"],
Cell[262581, 7015, 6579, 199, 139, "Output",ExpressionUUID->"e485a3c2-31b2-49ec-ac80-b24c28b8104d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269197, 7219, 2413, 59, 105, "Input",ExpressionUUID->"bea366a9-2633-4840-ae7f-a7a54d48569a"],
Cell[271613, 7280, 6730, 201, 145, "Output",ExpressionUUID->"5f00c7af-62ff-4655-8536-225541a2c966"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[278392, 7487, 613, 9, 86, "Section",ExpressionUUID->"64ee664b-fb04-4fa5-856f-f56107066b94"],
Cell[CellGroupData[{
Cell[279030, 7500, 886, 18, 78, "Input",ExpressionUUID->"6f47fbfa-d791-495e-b0ba-fb387023d70e"],
Cell[279919, 7520, 3216, 104, 78, "Output",ExpressionUUID->"c5d01494-6692-4c6f-b445-55e8c6e1dad6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283172, 7629, 367, 8, 51, "Input",ExpressionUUID->"9e5e29e6-9b31-4db4-8474-4f9ccf442af8"],
Cell[283542, 7639, 737, 25, 51, "Output",ExpressionUUID->"6c991ade-8682-4037-98a3-782a08e83701"]
}, Open  ]],
Cell[CellGroupData[{
Cell[284316, 7669, 375, 11, 51, "Input",ExpressionUUID->"a629d670-8bc2-4f7b-93f3-135357b7787d"],
Cell[284694, 7682, 527, 16, 51, "Output",ExpressionUUID->"9d722d59-be98-4052-8bee-4067af85f9d9"]
}, Open  ]],
Cell[285236, 7701, 1951, 43, 78, "Input",ExpressionUUID->"38d53818-8fe7-43c7-81ad-4f0cb13dd74c"],
Cell[CellGroupData[{
Cell[287212, 7748, 180, 3, 51, "Input",ExpressionUUID->"a8b6a53e-2b41-439b-aa27-490fc3a6efbf"],
Cell[287395, 7753, 3914, 120, 141, "Output",ExpressionUUID->"63bdbc56-66f6-4f18-a087-958d650bcaf2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[291346, 7878, 2612, 77, 183, "Input",ExpressionUUID->"6af137b1-c300-4511-90ef-7e78dccaad4e"],
Cell[293961, 7957, 970, 30, 51, "Output",ExpressionUUID->"0b60448b-bc26-4098-980f-5f794f96af86"]
}, Open  ]],
Cell[CellGroupData[{
Cell[294968, 7992, 182, 3, 51, "Input",ExpressionUUID->"61aa0324-586b-4c9d-bba9-0722e1155ca7"],
Cell[295153, 7997, 1566, 49, 75, "Output",ExpressionUUID->"f14db527-2264-411a-9486-68a422b26ec4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[296756, 8051, 831, 23, 78, "Input",ExpressionUUID->"d5ef5cd2-0033-4ab3-bad7-271f3e282c52"],
Cell[297590, 8076, 28477, 920, 540, "Output",ExpressionUUID->"876c7c6d-59ef-4910-bb5d-9f8dfda56e07"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326104, 9001, 1238, 39, 105, "Input",ExpressionUUID->"a9362f96-9a64-4f8e-80bb-4a4d489e4023"],
Cell[327345, 9042, 761, 14, 35, "Message",ExpressionUUID->"44de8091-11ae-4846-99be-ce52a3049b05"],
Cell[328109, 9058, 761, 14, 35, "Message",ExpressionUUID->"c13e3720-336d-4878-96c7-e430e612f715"],
Cell[328873, 9074, 759, 14, 35, "Message",ExpressionUUID->"d843e83b-a17c-4153-bde0-bc88259eb2cc"],
Cell[329635, 9090, 454, 10, 35, "Message",ExpressionUUID->"61f2690b-1562-4b02-8e1e-ee9261b5c181"]
}, Open  ]],
Cell[CellGroupData[{
Cell[330126, 9105, 1477, 43, 78, "Input",ExpressionUUID->"7be5350d-64c7-45f9-ad08-539630edbb93"],
Cell[331606, 9150, 1997, 55, 75, "Output",ExpressionUUID->"b964cd33-7eff-4f2b-81d1-ee74348e5314"]
}, Open  ]],
Cell[CellGroupData[{
Cell[333640, 9210, 3696, 108, 83, "Input",ExpressionUUID->"f3d5bcf1-a2f3-4ac3-8ebe-e913c7967d13"],
Cell[337339, 9320, 2789, 89, 81, "Output",ExpressionUUID->"98317660-7bae-499c-a977-e93b0281ad59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[340165, 9414, 1428, 34, 51, "Input",ExpressionUUID->"3665a4bf-2a22-46a6-833b-2c612a3a69d2"],
Cell[341596, 9450, 6579, 199, 145, "Output",ExpressionUUID->"a282a4d0-2e55-4ed9-a98b-53bb6516a692"]
}, Open  ]],
Cell[CellGroupData[{
Cell[348212, 9654, 2413, 59, 105, "Input",ExpressionUUID->"5ba17ce1-7990-4605-8f18-971cabb9b6bf"],
Cell[350628, 9715, 6730, 201, 145, "Output",ExpressionUUID->"73149c02-ebbd-4cdf-a55e-2dec7d76ae86"]
}, Open  ]]
}, Closed]]
}
]
*)

